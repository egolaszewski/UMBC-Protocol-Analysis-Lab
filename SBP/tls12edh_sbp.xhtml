<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol with TLS 1.2 Signed Ephemeral Diffie-Hellman (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald
  &quot;Session Binding Protocol with TLS 1.2 Signed Ephemeral Diffie-Hellman (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).&quot;
  (bound 12))
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from tls12edh_sbp.scm&quot;)
(comment &quot;Strand count bounded at 12&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t65">65</a> <a href="#t92">92</a> <a href="#t153">153</a> <a href="#t155">155</a> <a href="#t157">157</a> <a href="#t160">160</a> <a href="#t187">187</a> <a href="#t252">252</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='629.040pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 629.040 1654.920' font-size='12.000'>
  <text
   x='389.400' y='1601.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1526.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='1577.460' x2='339.480' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='239.640' y1='1577.460' x2='289.560' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1451.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='389.400' y1='1427.460' x2='439.320' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1376.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='389.400' y1='1427.460' x2='439.320' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='339.480' y1='1427.460' x2='389.400' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='1427.460' x2='339.480' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='389.400' y1='1277.460' x2='439.320' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='339.480' y1='1277.460' x2='389.400' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='389.400' y1='1127.460' x2='439.320' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='489.240' y1='977.460' x2='539.160' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='439.320' y1='977.460' x2='489.240' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='439.320' y1='864.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='926.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1001.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1076.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1151.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1226.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='289.560' y1='752.460' x2='339.480' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='239.640' y1='752.460' x2='289.560' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='389.400' y1='452.460' x2='439.320' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='439.320' y1='302.460' x2='489.240' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='389.400' y1='302.460' x2='439.320' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='489.240' y1='152.460' x2='539.160' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='439.320' y1='152.460' x2='489.240' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='827.460' x2='139.800' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 0</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 1</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 2</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 2)
  (parent 1)
  (unrealized (0 1) (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k5">5</a> <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 3</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 3)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k7">7</a> <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 4</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 4)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k9">9</a> <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 5</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 5)
  (parent 3)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 6</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 6)
  (parent 3)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k4">4</a>, Children: <a href="#k12">12</a> <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 7</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 7)
  (parent 4)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 8</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 8)
  (parent 4)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k5">5</a>, Children: <a href="#k15">15</a> <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 9</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 9)
  (parent 5)
  (unrealized (0 9) (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.320 375.660 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 10</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 10)
  (parent 5)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 11</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 11)
  (parent 6)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k7">7</a>, Children: <a href="#k19">19</a> <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 12</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-1)) cr sr)))
      (hash (hash (exp (gen) (mul y x-1)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 12)
  (parent 7)
  (unrealized (0 9) (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.583 376.118 45.326 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 13</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 13)
  (parent 7)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 14</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 14)
  (parent 8)
  (unrealized (0 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k9">9</a>, Children: <a href="#k23">23</a> <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 15</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))))
  (label 15)
  (parent 9)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k9">9</a>, Child: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 16</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 16)
  (parent 9)
  (unrealized (0 9) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k10">10</a>, Child: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.729 413.906 45.578 487.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 17</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 17)
  (parent 10)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t0">18</a>, Parent: <a href="#k11">11</a>, Children: <a href="#k27">27</a> <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 18</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 18)
  (parent 11)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k12">12</a>, Children: <a href="#k29">29</a> <a href="#k30">30</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 19</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))))
  (label 19)
  (parent 12)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t0">20</a>, Parent: <a href="#k12">12</a>, Child: <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 20</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 20)
  (parent 12)
  (unrealized (0 9) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k13">13</a>, Child: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.810 414.232 45.781 488.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 21</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k14">14</a>, Children: <a href="#k33">33</a> <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 22</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 22)
  (parent 14)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t0">23</a>, Parent: <a href="#k15">15</a>, Children: <a href="#k35">35</a> <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 23</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 23)
  (parent 15)
  (unrealized (1 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k15">15</a>, Child: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 141.138 524.718 42.396 784.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 24</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
  (label 24)
  (parent 15)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t0">25</a>, Parent: <a href="#k16">16</a>, Child: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 25</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 25)
  (parent 16)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k26">Item <a href="#t0">26</a>, Parent: <a href="#k17">17</a>, Children: <a href="#k39">39</a> <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 26</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 26)
  (parent 17)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t0">27</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 27</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 27)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k28">Item <a href="#t0">28</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 28</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 28)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k29">Item <a href="#t0">29</a>, Parent: <a href="#k19">19</a>, Children: <a href="#k41">41</a> <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 29</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 29)
  (parent 19)
  (unrealized (2 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k30">Item <a href="#t0">30</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 191.564 524.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 30</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
  (label 30)
  (parent 19)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t0">31</a>, Parent: <a href="#k20">20</a>, Child: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 31</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 31)
  (parent 20)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t0">32</a>, Parent: <a href="#k21">21</a>, Children: <a href="#k45">45</a> <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 32</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 32)
  (parent 21)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t0">33</a>, Parent: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 33</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 33)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k34">Item <a href="#t0">34</a>, Parent: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 34</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 34)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k35">Item <a href="#t0">35</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 35</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))))
  (label 35)
  (parent 23)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (spk spk) (y y) (x x)
        (cookie
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
        (any any) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (cr (0 0))
    (sr (1 1))))</pre>

<p id="k36">Item <a href="#t0">36</a>, Parent: <a href="#k23">23</a>, Child: <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 190.673 524.561 141.465 709.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 36</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 36)
  (parent 23)
  (unrealized (1 8) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t0">37</a>, Parent: <a href="#k24">24</a>, Child: <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.331 562.313 42.783 784.665'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 37</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
  (label 37)
  (parent 24)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t0">38</a>, Parent: <a href="#k25">25</a>, Children: <a href="#k49">49</a> <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 87.540 300.660 135.121 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 38</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 38)
  (parent 25)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t0">39</a>, Parent: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 39</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 39)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k40">Item <a href="#t0">40</a>, Parent: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 40</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 40)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k41">Item <a href="#t0">41</a>, Parent: <a href="#k29">29</a>, Seen Child: <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 41</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))))
  (label 41)
  (parent 29)
  (seen 35)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k42">Item <a href="#t0">42</a>, Parent: <a href="#k29">29</a>, Child: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 290.633 524.561 241.425 709.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 42</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 42)
  (parent 29)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t0">43</a>, Parent: <a href="#k30">30</a>, Child: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 191.774 562.617 43.707 785.274'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 43</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
  (label 43)
  (parent 30)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k44">Item <a href="#t0">44</a>, Parent: <a href="#k31">31</a>, Children: <a href="#k53">53</a> <a href="#k54">54</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 44</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 44)
  (parent 31)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k45">Item <a href="#t0">45</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 45</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 45)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k46">Item <a href="#t0">46</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 46</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 46)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k47">Item <a href="#t0">47</a>, Parent: <a href="#k36">36</a>, Child: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 190.848 562.114 141.817 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 47</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 47)
  (parent 36)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k48">Item <a href="#t0">48</a>, Parent: <a href="#k37">37</a>, Children: <a href="#k56">56</a> <a href="#k57">57</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.584 599.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 48</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 48)
  (parent 37)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k49">Item <a href="#t0">49</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 88.276 337.464 136.593 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 49</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 49)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k50">Item <a href="#t0">50</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 88.276 337.464 136.593 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 50</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 50)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k51">Item <a href="#t0">51</a>, Parent: <a href="#k42">42</a>, Child: <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 290.808 562.114 241.777 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 51</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 51)
  (parent 42)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k52">Item <a href="#t0">52</a>, Parent: <a href="#k43">43</a>, Children: <a href="#k59">59</a> <a href="#k60">60</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 52</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 52)
  (parent 43)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k53">Item <a href="#t0">53</a>, Parent: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 53</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 53)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k54">Item <a href="#t0">54</a>, Parent: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 54</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 54)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k55">Item <a href="#t0">55</a>, Parent: <a href="#k47">47</a>, Children: <a href="#k61">61</a> <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.118 599.718 142.356 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 55</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 55)
  (parent 47)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k56">Item <a href="#t0">56</a>, Parent: <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 56</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 56)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k57">Item <a href="#t0">57</a>, Parent: <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 57</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 57)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k58">Item <a href="#t0">58</a>, Parent: <a href="#k51">51</a>, Children: <a href="#k63">63</a> <a href="#k64">64</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.078 599.718 242.316 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 58</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 58)
  (parent 51)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t0">59</a>, Parent: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 59</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 59)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k60">Item <a href="#t0">60</a>, Parent: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 60</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 60)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k61">Item <a href="#t0">61</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 191.564 637.464 143.247 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 61</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 61)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k62">Item <a href="#t0">62</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 191.564 637.464 143.247 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 62</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 62)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k63">Item <a href="#t0">63</a>, Parent: <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 291.524 637.464 243.207 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 63</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 63)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k64">Item <a href="#t0">64</a>, Parent: <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 291.524 637.464 243.207 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 64</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 64)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t65">Tree <a href="#top">65</a>, POV <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='479.280pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.280 604.920' font-size='12.000'>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='339.480' y1='527.460' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='339.480' y1='527.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='189.720' y1='452.460' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='389.400' y1='377.460' x2='439.320' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='389.400' y1='377.460' x2='439.320' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='339.480' y1='377.460' x2='389.400' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='289.560' y1='377.460' x2='339.480' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='239.640' y1='377.460' x2='289.560' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='189.720' y1='452.460' x2='239.640' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='139.800' y1='302.460' x2='189.720' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='289.560' y1='227.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='239.640' y1='227.460' x2='289.560' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='289.560' y1='77.460' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='139.800' y1='302.460' x2='189.720' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='89.880' y1='302.460' x2='139.800' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='39.960' y1='302.460' x2='89.880' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k65">Item <a href="#t65">65</a>, Child: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 65</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie)))
  (label 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k66">Item <a href="#t65">66</a>, Parent: <a href="#k65">65</a>, Child: <a href="#k67">67</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 66</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie)))
  (label 66)
  (parent 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k67">Item <a href="#t65">67</a>, Parent: <a href="#k66">66</a>, Children: <a href="#k68">68</a> <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 67</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 67)
  (parent 66)
  (unrealized (0 1) (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t65">68</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k70">70</a> <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 68</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 68)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t65">69</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k72">72</a> <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 69</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 69)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k70">Item <a href="#t65">70</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 70</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 70)
  (parent 68)
  (unrealized (0 5) (0 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k71">Item <a href="#t65">71</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 71</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((2 1) (0 1)) ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 71)
  (parent 68)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t65">72</a>, Parent: <a href="#k69">69</a>, Child: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 72</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 72)
  (parent 69)
  (unrealized (0 5) (0 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k73">Item <a href="#t65">73</a>, Parent: <a href="#k69">69</a>, Child: <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 242.880 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 73</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 73)
  (parent 69)
  (unrealized (0 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k74">Item <a href="#t65">74</a>, Parent: <a href="#k70">70</a>, Child: <a href="#k78">78</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.583 376.118 45.326 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 74</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 74)
  (parent 70)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t65">75</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 75</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 75)
  (parent 71)
  (unrealized (0 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k76">Item <a href="#t65">76</a>, Parent: <a href="#k72">72</a>, Child: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 242.689 376.406 45.578 487.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 76</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 76)
  (parent 72)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k77">Item <a href="#t65">77</a>, Parent: <a href="#k73">73</a>, Child: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 242.880 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 77</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 77)
  (parent 73)
  (unrealized (0 3) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k78">Item <a href="#t65">78</a>, Parent: <a href="#k74">74</a>, Child: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.810 414.232 45.781 488.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 78</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 78)
  (parent 74)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k79">Item <a href="#t65">79</a>, Parent: <a href="#k75">75</a>, Children: <a href="#k83">83</a> <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 79</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 79)
  (parent 75)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k80">Item <a href="#t65">80</a>, Parent: <a href="#k76">76</a>, Child: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 242.829 414.407 45.857 488.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 80</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 80)
  (parent 76)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k81">Item <a href="#t65">81</a>, Parent: <a href="#k77">77</a>, Children: <a href="#k86">86</a> <a href="#k87">87</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.880 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 81</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 81)
  (parent 77)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k82">Item <a href="#t65">82</a>, Parent: <a href="#k78">78</a>, Children: <a href="#k88">88</a> <a href="#k89">89</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 82</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 82)
  (parent 78)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k83">Item <a href="#t65">83</a>, Parent: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 83</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 83)
  (parent 79)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k84">Item <a href="#t65">84</a>, Parent: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 84</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 84)
  (parent 79)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k85">Item <a href="#t65">85</a>, Parent: <a href="#k80">80</a>, Children: <a href="#k90">90</a> <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.880 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 85</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 85)
  (parent 80)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t65">86</a>, Parent: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 86</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 86)
  (parent 81)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k87">Item <a href="#t65">87</a>, Parent: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 87</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 87)
  (parent 81)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k88">Item <a href="#t65">88</a>, Parent: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 88</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 88)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k89">Item <a href="#t65">89</a>, Parent: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 89</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 89)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k90">Item <a href="#t65">90</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 90</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 90)
  (parent 85)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k91">Item <a href="#t65">91</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 91</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 91)
  (parent 85)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t92">Tree <a href="#top">92</a>, POV <a href="#k92">92</a>.</p>

<div>
 <svg
  class='diagram' width='579.120pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.120 1429.920' font-size='12.000'>
  <text
   x='389.400' y='1376.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k124&quot;, &quot;_self&quot;)'>124</text>
  <line
   x1='339.480' y1='1352.460' x2='389.400' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k123&quot;, &quot;_self&quot;)'>123</text>
  <line
   x1='339.480' y1='1352.460' x2='389.400' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1338.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='289.560' y1='1352.460' x2='339.480' y2='1352.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1338.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='239.640' y1='1352.460' x2='289.560' y2='1352.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1338.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='189.720' y1='1052.460' x2='239.640' y2='1352.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='439.320' y1='1202.460' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k143&quot;, &quot;_self&quot;)'>143</text>
  <line
   x1='439.320' y1='1202.460' x2='489.240' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1188.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k133&quot;, &quot;_self&quot;)'>133</text>
  <line
   x1='389.400' y1='1202.460' x2='439.320' y2='1202.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1188.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k122&quot;, &quot;_self&quot;)'>122</text>
  <line
   x1='339.480' y1='1202.460' x2='389.400' y2='1202.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1188.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='289.560' y1='977.460' x2='339.480' y2='1202.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k152&quot;, &quot;_self&quot;)'>152</text>
  <line
   x1='489.240' y1='1052.460' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k151&quot;, &quot;_self&quot;)'>151</text>
  <line
   x1='489.240' y1='1052.460' x2='539.160' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1038.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k142&quot;, &quot;_self&quot;)'>142</text>
  <line
   x1='439.320' y1='1052.460' x2='489.240' y2='1052.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1038.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='389.400' y1='1052.460' x2='439.320' y2='1052.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1038.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k121&quot;, &quot;_self&quot;)'>121</text>
  <line
   x1='339.480' y1='977.460' x2='389.400' y2='1052.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k141&quot;, &quot;_self&quot;)'>141</text>
  <line
   x1='439.320' y1='939.960' x2='489.240' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k131&quot;, &quot;_self&quot;)'>131</text>
  <line
   x1='389.400' y1='902.460' x2='439.320' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k140&quot;, &quot;_self&quot;)'>140</text>
  <line
   x1='439.320' y1='864.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k130&quot;, &quot;_self&quot;)'>130</text>
  <line
   x1='389.400' y1='902.460' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='888.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k120&quot;, &quot;_self&quot;)'>120</text>
  <line
   x1='339.480' y1='977.460' x2='389.400' y2='902.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k110&quot;, &quot;_self&quot;)'>110</text>
  <line
   x1='289.560' y1='977.460' x2='339.480' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k150&quot;, &quot;_self&quot;)'>150</text>
  <line
   x1='489.240' y1='752.460' x2='539.160' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k149&quot;, &quot;_self&quot;)'>149</text>
  <line
   x1='489.240' y1='752.460' x2='539.160' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k139&quot;, &quot;_self&quot;)'>139</text>
  <line
   x1='439.320' y1='752.460' x2='489.240' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='389.400' y1='752.460' x2='439.320' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k119&quot;, &quot;_self&quot;)'>119</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k109&quot;, &quot;_self&quot;)'>109</text>
  <line
   x1='289.560' y1='977.460' x2='339.480' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='239.640' y1='977.460' x2='289.560' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='189.720' y1='1052.460' x2='239.640' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1038.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='139.800' y1='714.960' x2='189.720' y2='1052.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k117&quot;, &quot;_self&quot;)'>117</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='239.640' y1='602.460' x2='289.560' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k138&quot;, &quot;_self&quot;)'>138</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k137&quot;, &quot;_self&quot;)'>137</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='389.400' y1='452.460' x2='439.320' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k116&quot;, &quot;_self&quot;)'>116</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k148&quot;, &quot;_self&quot;)'>148</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k147&quot;, &quot;_self&quot;)'>147</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k136&quot;, &quot;_self&quot;)'>136</text>
  <line
   x1='439.320' y1='302.460' x2='489.240' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k127&quot;, &quot;_self&quot;)'>127</text>
  <line
   x1='389.400' y1='302.460' x2='439.320' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  <line
   x1='339.480' y1='264.960' x2='389.400' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='439.320' y1='189.960' x2='489.240' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k126&quot;, &quot;_self&quot;)'>126</text>
  <line
   x1='389.400' y1='189.960' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='339.480' y1='264.960' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k146&quot;, &quot;_self&quot;)'>146</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k145&quot;, &quot;_self&quot;)'>145</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k134&quot;, &quot;_self&quot;)'>134</text>
  <line
   x1='439.320' y1='77.460' x2='489.240' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k125&quot;, &quot;_self&quot;)'>125</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k113&quot;, &quot;_self&quot;)'>113</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='139.800' y1='714.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='89.880' y1='714.960' x2='139.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='39.960' y1='714.960' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k92">Item <a href="#t92">92</a>, Child: <a href="#k93">93</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 92</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 92)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k93">Item <a href="#t92">93</a>, Parent: <a href="#k92">92</a>, Child: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 93</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 93)
  (parent 92)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k94">Item <a href="#t92">94</a>, Parent: <a href="#k93">93</a>, Children: <a href="#k95">95</a> <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 94</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 94)
  (parent 93)
  (unrealized (0 1) (0 3) (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k95">Item <a href="#t92">95</a>, Parent: <a href="#k94">94</a>, Children: <a href="#k97">97</a> <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 95</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 95)
  (parent 94)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k96">Item <a href="#t92">96</a>, Parent: <a href="#k94">94</a>, Children: <a href="#k99">99</a> <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 96</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 96)
  (parent 94)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k97">Item <a href="#t92">97</a>, Parent: <a href="#k95">95</a>, Child: <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 97</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 97)
  (parent 95)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k98">Item <a href="#t92">98</a>, Parent: <a href="#k95">95</a>, Child: <a href="#k102">102</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 98</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 98)
  (parent 95)
  (unrealized (0 3) (0 4) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k99">Item <a href="#t92">99</a>, Parent: <a href="#k96">96</a>, Child: <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 99</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 99)
  (parent 96)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k100">Item <a href="#t92">100</a>, Parent: <a href="#k96">96</a>, Child: <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 100</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 100)
  (parent 96)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k101">Item <a href="#t92">101</a>, Parent: <a href="#k97">97</a>, Children: <a href="#k105">105</a> <a href="#k106">106</a> <a href="#k107">107</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 101</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie))))
  (label 101)
  (parent 97)
  (unrealized (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k102">Item <a href="#t92">102</a>, Parent: <a href="#k98">98</a>, Child: <a href="#k108">108</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 102</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 102)
  (parent 98)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k103">Item <a href="#t92">103</a>, Parent: <a href="#k99">99</a>, Children: <a href="#k109">109</a> <a href="#k110">110</a> <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 103</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie))))
  (label 103)
  (parent 99)
  (unrealized (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k104">Item <a href="#t92">104</a>, Parent: <a href="#k100">100</a>, Child: <a href="#k112">112</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 104</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 104)
  (parent 100)
  (unrealized (0 3) (0 4) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k105">Item <a href="#t92">105</a>, Parent: <a href="#k101">101</a>, Child: <a href="#k113">113</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 105</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;)))))
  (label 105)
  (parent 101)
  (unrealized (2 4) (2 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k106">Item <a href="#t92">106</a>, Parent: <a href="#k101">101</a>, Children: <a href="#k114">114</a> <a href="#k115">115</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 106</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;)))))
  (label 106)
  (parent 101)
  (unrealized (2 4) (2 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k107">Item <a href="#t92">107</a>, Parent: <a href="#k101">101</a>, Child: <a href="#k116">116</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 191.564 524.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 107</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 107)
  (parent 101)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k108">Item <a href="#t92">108</a>, Parent: <a href="#k102">102</a>, Children: <a href="#k117">117</a> <a href="#k118">118</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 108</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 108)
  (parent 102)
  (unrealized (0 4) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k109">Item <a href="#t92">109</a>, Parent: <a href="#k103">103</a>, Child: <a href="#k119">119</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 109</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) &quot;server_write&quot;))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;)))))
  (label 109)
  (parent 103)
  (unrealized (3 4) (3 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k110">Item <a href="#t92">110</a>, Parent: <a href="#k103">103</a>, Children: <a href="#k120">120</a> <a href="#k121">121</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 110</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) &quot;server_write&quot;))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;)))))
  (label 110)
  (parent 103)
  (unrealized (3 4) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k111">Item <a href="#t92">111</a>, Parent: <a href="#k103">103</a>, Child: <a href="#k122">122</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 241.873 525.217 43.945 785.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 111</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 111)
  (parent 103)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k112">Item <a href="#t92">112</a>, Parent: <a href="#k104">104</a>, Children: <a href="#k123">123</a> <a href="#k124">124</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 112</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 112)
  (parent 104)
  (unrealized (0 4) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k113">Item <a href="#t92">113</a>, Parent: <a href="#k105">105</a>, Child: <a href="#k125">125</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 113</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 113)
  (parent 105)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k114">Item <a href="#t92">114</a>, Parent: <a href="#k106">106</a>, Child: <a href="#k126">126</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: orange;' cx='239.880' cy='789.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 114</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;)))))
  (label 114)
  (parent 106)
  (unrealized (1 5) (2 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k115">Item <a href="#t92">115</a>, Parent: <a href="#k106">106</a>, Child: <a href="#k127">127</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 115</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (enc
      (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 115)
  (parent 106)
  (unrealized (2 4) (2 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k116">Item <a href="#t92">116</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 191.774 562.617 43.707 785.274'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 116</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 116)
  (parent 107)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k117">Item <a href="#t92">117</a>, Parent: <a href="#k108">108</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 117</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 117)
  (parent 108)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k118">Item <a href="#t92">118</a>, Parent: <a href="#k108">108</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 118</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 118)
  (parent 108)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k119">Item <a href="#t92">119</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k129">129</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 119</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 119)
  (parent 109)
  (unrealized (3 8) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k120">Item <a href="#t92">120</a>, Parent: <a href="#k110">110</a>, Children: <a href="#k130">130</a> <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: orange;' cx='339.840' cy='789.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 120</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (2 5)) ((0 2) (3 2)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-1)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) &quot;client_write&quot;))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;)))))
  (label 120)
  (parent 110)
  (unrealized (2 5) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k121">Item <a href="#t92">121</a>, Parent: <a href="#k110">110</a>, Child: <a href="#k132">132</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 121</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (enc
      (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 121)
  (parent 110)
  (unrealized (3 4) (3 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k122">Item <a href="#t92">122</a>, Parent: <a href="#k111">111</a>, Child: <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 242.068 562.908 44.336 785.855'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 122</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 122)
  (parent 111)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k123">Item <a href="#t92">123</a>, Parent: <a href="#k112">112</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 123</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 123)
  (parent 112)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k124">Item <a href="#t92">124</a>, Parent: <a href="#k112">112</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 124</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 124)
  (parent 112)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k125">Item <a href="#t92">125</a>, Parent: <a href="#k113">113</a>, Child: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 125</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 125)
  (parent 113)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k126">Item <a href="#t92">126</a>, Parent: <a href="#k114">114</a>, Child: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1) (enc (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 126</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 126)
  (parent 114)
  (unrealized (1 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k127">Item <a href="#t92">127</a>, Parent: <a href="#k115">115</a>, Child: <a href="#k136">136</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 127</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 127)
  (parent 115)
  (unrealized (2 4) (2 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k128">Item <a href="#t92">128</a>, Parent: <a href="#k116">116</a>, Children: <a href="#k137">137</a> <a href="#k138">138</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 128</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 128)
  (parent 116)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k129">Item <a href="#t92">129</a>, Parent: <a href="#k119">119</a>, Child: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 129</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 129)
  (parent 119)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k130">Item <a href="#t92">130</a>, Parent: <a href="#k120">120</a>, Child: <a href="#k140">140</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-1 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1) (enc (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 130</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 1) (0 1)) ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 130)
  (parent 120)
  (unrealized (1 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k131">Item <a href="#t92">131</a>, Parent: <a href="#k120">120</a>, Child: <a href="#k141">141</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 391.484 712.464 343.167 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 342.840 452.460 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-2 y-1)) &quot;server finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1) (enc (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-2) (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor) (x x-2) (y y-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 131</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-2) (y y-1))
  (precedes ((0 0) (3 0)) ((0 2) (2 5)) ((0 2) (3 2)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)) ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot;
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) &quot;server finished&quot;
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot;
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 131)
  (parent 120)
  (unrealized (2 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k132">Item <a href="#t92">132</a>, Parent: <a href="#k121">121</a>, Child: <a href="#k142">142</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 132</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 132)
  (parent 121)
  (unrealized (3 4) (3 5) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k133">Item <a href="#t92">133</a>, Parent: <a href="#k122">122</a>, Children: <a href="#k143">143</a> <a href="#k144">144</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.280 600.660 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 133</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 133)
  (parent 122)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k134">Item <a href="#t92">134</a>, Parent: <a href="#k125">125</a>, Children: <a href="#k145">145</a> <a href="#k146">146</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.913 487.717 43.945 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.340 675.660 44.759 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 134</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 134)
  (parent 125)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k135">Item <a href="#t92">135</a>, Parent: <a href="#k126">126</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 292.543 376.118 145.286 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1) (enc (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.927 337.717 235.895 485.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 135</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 5) (1 5)) ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (1 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
  (label 135)
  (parent 126)
  (unrealized (1 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k136">Item <a href="#t92">136</a>, Parent: <a href="#k127">127</a>, Children: <a href="#k147">147</a> <a href="#k148">148</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.320 675.660 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.320 450.660 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 136</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 136)
  (parent 127)
  (unrealized (2 4) (2 5) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k137">Item <a href="#t92">137</a>, Parent: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 137</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 137)
  (parent 128)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k138">Item <a href="#t92">138</a>, Parent: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 138</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 138)
  (parent 128)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k139">Item <a href="#t92">139</a>, Parent: <a href="#k129">129</a>, Children: <a href="#k149">149</a> <a href="#k150">150</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.300 488.160 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.729 638.906 45.578 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 139</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 139)
  (parent 129)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k140">Item <a href="#t92">140</a>, Parent: <a href="#k130">130</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 292.543 376.118 145.286 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-1 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1) (enc (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.927 337.717 235.895 485.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 140</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 1) (0 1)) ((3 5) (1 5)) ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (1 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
  (label 140)
  (parent 130)
  (unrealized (1 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k141">Item <a href="#t92">141</a>, Parent: <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 392.503 376.118 245.246 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 391.484 712.464 343.167 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 342.840 452.460 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-2 y-1)) &quot;server finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1) (enc (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-1) (enc (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot; (hash cr-2 sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (cat (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))) (exp (gen) y-1))) (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1))) (exp (gen) x-2) (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))) request (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.500 338.160 335.041 486.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-2) (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor) (x x-2) (y y-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 141</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-2) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)) ((4 5) (2 5)) ((4 7) (3 5)) ((5 1) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
    (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot;
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) &quot;server finished&quot;
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) &quot;client finished&quot;
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            &quot;server_write&quot;))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
  (label 141)
  (parent 131)
  (unrealized (2 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k142">Item <a href="#t92">142</a>, Parent: <a href="#k132">132</a>, Children: <a href="#k151">151</a> <a href="#k152">152</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.583 676.118 45.326 787.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 142</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 142)
  (parent 132)
  (unrealized (3 4) (3 5) (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k143">Item <a href="#t92">143</a>, Parent: <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.494 638.489 45.189 787.018'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 143</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 143)
  (parent 133)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k144">Item <a href="#t92">144</a>, Parent: <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.494 638.489 45.189 787.018'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 144</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 144)
  (parent 133)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k145">Item <a href="#t92">145</a>, Parent: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 91.604 712.464 43.287 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 145</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 145)
  (parent 134)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k146">Item <a href="#t92">146</a>, Parent: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 91.604 712.464 43.287 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 146</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 146)
  (parent 134)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k147">Item <a href="#t92">147</a>, Parent: <a href="#k136">136</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.729 713.906 45.578 787.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.729 488.906 45.578 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 147</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 147)
  (parent 136)
  (unrealized (2 4) (2 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k148">Item <a href="#t92">148</a>, Parent: <a href="#k136">136</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.729 713.906 45.578 787.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.729 488.906 45.578 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 148</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 148)
  (parent 136)
  (unrealized (2 4) (2 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k149">Item <a href="#t92">149</a>, Parent: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.320 675.660 44.759 786.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 149</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 149)
  (parent 139)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k150">Item <a href="#t92">150</a>, Parent: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.320 675.660 44.759 786.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 150</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 150)
  (parent 139)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k151">Item <a href="#t92">151</a>, Parent: <a href="#k142">142</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 192.810 714.232 45.781 788.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.810 489.232 45.781 563.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 151</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 151)
  (parent 142)
  (unrealized (3 4) (3 5) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k152">Item <a href="#t92">152</a>, Parent: <a href="#k142">142</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 192.810 714.232 45.781 788.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.810 489.232 45.781 563.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 152</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 152)
  (parent 142)
  (unrealized (3 4) (3 5) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t153">Tree <a href="#top">153</a>, POV <a href="#k153">153</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k154&quot;, &quot;_self&quot;)'>154</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k153&quot;, &quot;_self&quot;)'>153</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k153">Item <a href="#t153">153</a>, Child: <a href="#k154">154</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 153</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))))
  (label 153)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k154">Item <a href="#t153">154</a>, Parent: <a href="#k153">153</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 154</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))))
  (label 154)
  (parent 153)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))</pre>

<p id="t155">Tree <a href="#top">155</a>, POV <a href="#k155">155</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k156&quot;, &quot;_self&quot;)'>156</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k155&quot;, &quot;_self&quot;)'>155</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k155">Item <a href="#t155">155</a>, Child: <a href="#k156">156</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 155</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))))
  (label 155)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k156">Item <a href="#t155">156</a>, Parent: <a href="#k155">155</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 156</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))))
  (label 156)
  (parent 155)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))</pre>

<p id="t157">Tree <a href="#top">157</a>, POV <a href="#k157">157</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 79.920' font-size='12.000'>
  <text
   x='139.800' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k159&quot;, &quot;_self&quot;)'>159</text>
  <line
   x1='89.880' y1='39.960' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k158&quot;, &quot;_self&quot;)'>158</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k157&quot;, &quot;_self&quot;)'>157</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k157">Item <a href="#t157">157</a>, Child: <a href="#k158">158</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 157</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie))))
  (label 157)
  (unrealized (0 4))
  (origs (sr (0 1)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k158">Item <a href="#t157">158</a>, Parent: <a href="#k157">157</a>, Child: <a href="#k159">159</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 158</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (gen-st (cat &quot;server store&quot; s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie))))
  (label 158)
  (parent 157)
  (unrealized (0 4) (0 5))
  (origs (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k159">Item <a href="#t157">159</a>, Parent: <a href="#k158">158</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 91.604 337.464 43.287 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul x y)) cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul x y)) cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 159</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (deflistener (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
  (precedes ((0 1) (1 0)) ((1 1) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (gen-st (cat &quot;server store&quot; s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (0 4))
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
  (label 159)
  (parent 158)
  (unrealized (0 5) (1 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t160">Tree <a href="#top">160</a>, POV <a href="#k160">160</a>.</p>

<div>
 <svg
  class='diagram' width='479.280pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.280 604.920' font-size='12.000'>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k182&quot;, &quot;_self&quot;)'>182</text>
  <line
   x1='339.480' y1='527.460' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k181&quot;, &quot;_self&quot;)'>181</text>
  <line
   x1='339.480' y1='527.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k176&quot;, &quot;_self&quot;)'>176</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k172&quot;, &quot;_self&quot;)'>172</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k168&quot;, &quot;_self&quot;)'>168</text>
  <line
   x1='189.720' y1='452.460' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k186&quot;, &quot;_self&quot;)'>186</text>
  <line
   x1='389.400' y1='377.460' x2='439.320' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k185&quot;, &quot;_self&quot;)'>185</text>
  <line
   x1='389.400' y1='377.460' x2='439.320' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k180&quot;, &quot;_self&quot;)'>180</text>
  <line
   x1='339.480' y1='377.460' x2='389.400' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k175&quot;, &quot;_self&quot;)'>175</text>
  <line
   x1='289.560' y1='377.460' x2='339.480' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k171&quot;, &quot;_self&quot;)'>171</text>
  <line
   x1='239.640' y1='377.460' x2='289.560' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k167&quot;, &quot;_self&quot;)'>167</text>
  <line
   x1='189.720' y1='452.460' x2='239.640' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k164&quot;, &quot;_self&quot;)'>164</text>
  <line
   x1='139.800' y1='302.460' x2='189.720' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k179&quot;, &quot;_self&quot;)'>179</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k178&quot;, &quot;_self&quot;)'>178</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k174&quot;, &quot;_self&quot;)'>174</text>
  <line
   x1='289.560' y1='227.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k170&quot;, &quot;_self&quot;)'>170</text>
  <line
   x1='239.640' y1='227.460' x2='289.560' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k166&quot;, &quot;_self&quot;)'>166</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k184&quot;, &quot;_self&quot;)'>184</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k183&quot;, &quot;_self&quot;)'>183</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k177&quot;, &quot;_self&quot;)'>177</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k173&quot;, &quot;_self&quot;)'>173</text>
  <line
   x1='289.560' y1='77.460' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k169&quot;, &quot;_self&quot;)'>169</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k165&quot;, &quot;_self&quot;)'>165</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k163&quot;, &quot;_self&quot;)'>163</text>
  <line
   x1='139.800' y1='302.460' x2='189.720' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k162&quot;, &quot;_self&quot;)'>162</text>
  <line
   x1='89.880' y1='302.460' x2='139.800' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k161&quot;, &quot;_self&quot;)'>161</text>
  <line
   x1='39.960' y1='302.460' x2='89.880' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k160&quot;, &quot;_self&quot;)'>160</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k160">Item <a href="#t160">160</a>, Child: <a href="#k161">161</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 160</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (p password) (cr sr random32) (spk akey)
        (u s ca name) (y rndx) (x expt) (z z-0 strd))
      (implies
        (and (p &quot;clienta&quot; z 10) (p &quot;&quot; z-0 2)
          (p &quot;clienta&quot; &quot;cookie&quot; z cookie) (p &quot;clienta&quot; &quot;p&quot; z p)
          (p &quot;clienta&quot; &quot;cr&quot; z cr) (p &quot;clienta&quot; &quot;sr&quot; z sr)
          (p &quot;clienta&quot; &quot;spk&quot; z spk) (p &quot;clienta&quot; &quot;u&quot; z u)
          (p &quot;clienta&quot; &quot;s&quot; z s) (p &quot;clienta&quot; &quot;ca&quot; z ca)
          (p &quot;clienta&quot; &quot;y&quot; z y) (p &quot;clienta&quot; &quot;x&quot; z x)
          (p &quot;&quot; &quot;x&quot; z-0 cookie) (non (invk spk)) (non (privk ca))
          (pnon p) (uniq sr) (ugen y) (uniq-at cr z 0)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 160)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k161">Item <a href="#t160">161</a>, Parent: <a href="#k160">160</a>, Child: <a href="#k162">162</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 161</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 161)
  (parent 160)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k162">Item <a href="#t160">162</a>, Parent: <a href="#k161">161</a>, Children: <a href="#k163">163</a> <a href="#k164">164</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 162</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 162)
  (parent 161)
  (unrealized (1 1) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k163">Item <a href="#t160">163</a>, Parent: <a href="#k162">162</a>, Children: <a href="#k165">165</a> <a href="#k166">166</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 163</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 163)
  (parent 162)
  (unrealized (1 3) (1 5) (1 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k164">Item <a href="#t160">164</a>, Parent: <a href="#k162">162</a>, Children: <a href="#k167">167</a> <a href="#k168">168</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 164</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 164)
  (parent 162)
  (unrealized (1 3) (1 5) (1 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k165">Item <a href="#t160">165</a>, Parent: <a href="#k163">163</a>, Child: <a href="#k169">169</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 165</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 165)
  (parent 163)
  (unrealized (1 5) (1 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k166">Item <a href="#t160">166</a>, Parent: <a href="#k163">163</a>, Child: <a href="#k170">170</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 166</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (3 0)) ((2 1) (1 1)) ((3 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 166)
  (parent 163)
  (unrealized (1 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k167">Item <a href="#t160">167</a>, Parent: <a href="#k164">164</a>, Child: <a href="#k171">171</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 167</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 167)
  (parent 164)
  (unrealized (1 5) (1 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k168">Item <a href="#t160">168</a>, Parent: <a href="#k164">164</a>, Child: <a href="#k172">172</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 292.860 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 168</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 168)
  (parent 164)
  (unrealized (1 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k169">Item <a href="#t160">169</a>, Parent: <a href="#k165">165</a>, Child: <a href="#k173">173</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 242.280 375.660 144.719 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 169</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 169)
  (parent 165)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k170">Item <a href="#t160">170</a>, Parent: <a href="#k166">166</a>, Child: <a href="#k174">174</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 242.880 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 170</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 170)
  (parent 166)
  (unrealized (1 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k171">Item <a href="#t160">171</a>, Parent: <a href="#k167">167</a>, Child: <a href="#k175">175</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 292.543 376.118 145.286 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 171</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 171)
  (parent 167)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k172">Item <a href="#t160">172</a>, Parent: <a href="#k168">168</a>, Child: <a href="#k176">176</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 292.860 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 172</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 172)
  (parent 168)
  (unrealized (1 3) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k173">Item <a href="#t160">173</a>, Parent: <a href="#k169">169</a>, Child: <a href="#k177">177</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 242.689 413.906 145.538 487.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 173</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 173)
  (parent 169)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k174">Item <a href="#t160">174</a>, Parent: <a href="#k170">170</a>, Children: <a href="#k178">178</a> <a href="#k179">179</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 174</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 174)
  (parent 170)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k175">Item <a href="#t160">175</a>, Parent: <a href="#k171">171</a>, Child: <a href="#k180">180</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 292.770 414.232 145.741 488.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 175</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 175)
  (parent 171)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k176">Item <a href="#t160">176</a>, Parent: <a href="#k172">172</a>, Children: <a href="#k181">181</a> <a href="#k182">182</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 292.860 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 176</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 176)
  (parent 172)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k177">Item <a href="#t160">177</a>, Parent: <a href="#k173">173</a>, Children: <a href="#k183">183</a> <a href="#k184">184</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 177</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 177)
  (parent 173)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k178">Item <a href="#t160">178</a>, Parent: <a href="#k174">174</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 242.880 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 178</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 178)
  (parent 174)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k179">Item <a href="#t160">179</a>, Parent: <a href="#k174">174</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 242.880 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 179</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 179)
  (parent 174)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k180">Item <a href="#t160">180</a>, Parent: <a href="#k175">175</a>, Children: <a href="#k185">185</a> <a href="#k186">186</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 292.860 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 180</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 180)
  (parent 175)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k181">Item <a href="#t160">181</a>, Parent: <a href="#k176">176</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 292.860 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 436.800 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 181</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 181)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k182">Item <a href="#t160">182</a>, Parent: <a href="#k176">176</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 292.860 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 436.800 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 182</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 182)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k183">Item <a href="#t160">183</a>, Parent: <a href="#k177">177</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 242.880 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 183</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 183)
  (parent 177)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k184">Item <a href="#t160">184</a>, Parent: <a href="#k177">177</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 242.880 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 184</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 184)
  (parent 177)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k185">Item <a href="#t160">185</a>, Parent: <a href="#k180">180</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 292.860 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.689 338.906 145.538 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 436.800 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 185</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 185)
  (parent 180)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k186">Item <a href="#t160">186</a>, Parent: <a href="#k180">180</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 292.860 527.460 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.689 338.906 145.538 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 436.800 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 186</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 186)
  (parent 180)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t187">Tree <a href="#top">187</a>, POV <a href="#k187">187</a>.</p>

<div>
 <svg
  class='diagram' width='629.040pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 629.040 1654.920' font-size='12.000'>
  <text
   x='389.400' y='1601.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k221&quot;, &quot;_self&quot;)'>221</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1526.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k220&quot;, &quot;_self&quot;)'>220</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k209&quot;, &quot;_self&quot;)'>209</text>
  <line
   x1='289.560' y1='1577.460' x2='339.480' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k201&quot;, &quot;_self&quot;)'>201</text>
  <line
   x1='239.640' y1='1577.460' x2='289.560' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k195&quot;, &quot;_self&quot;)'>195</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1451.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k233&quot;, &quot;_self&quot;)'>233</text>
  <line
   x1='389.400' y1='1427.460' x2='439.320' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1376.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k232&quot;, &quot;_self&quot;)'>232</text>
  <line
   x1='389.400' y1='1427.460' x2='439.320' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k219&quot;, &quot;_self&quot;)'>219</text>
  <line
   x1='339.480' y1='1427.460' x2='389.400' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k208&quot;, &quot;_self&quot;)'>208</text>
  <line
   x1='289.560' y1='1427.460' x2='339.480' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k200&quot;, &quot;_self&quot;)'>200</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k241&quot;, &quot;_self&quot;)'>241</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k240&quot;, &quot;_self&quot;)'>240</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k231&quot;, &quot;_self&quot;)'>231</text>
  <line
   x1='389.400' y1='1277.460' x2='439.320' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k218&quot;, &quot;_self&quot;)'>218</text>
  <line
   x1='339.480' y1='1277.460' x2='389.400' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k207&quot;, &quot;_self&quot;)'>207</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k247&quot;, &quot;_self&quot;)'>247</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k246&quot;, &quot;_self&quot;)'>246</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k239&quot;, &quot;_self&quot;)'>239</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k230&quot;, &quot;_self&quot;)'>230</text>
  <line
   x1='389.400' y1='1127.460' x2='439.320' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k217&quot;, &quot;_self&quot;)'>217</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k251&quot;, &quot;_self&quot;)'>251</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k250&quot;, &quot;_self&quot;)'>250</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k245&quot;, &quot;_self&quot;)'>245</text>
  <line
   x1='489.240' y1='977.460' x2='539.160' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k238&quot;, &quot;_self&quot;)'>238</text>
  <line
   x1='439.320' y1='977.460' x2='489.240' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k229&quot;, &quot;_self&quot;)'>229</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k222&quot;, &quot;_self&quot;)'>222</text>
  <line
   x1='439.320' y1='864.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k228&quot;, &quot;_self&quot;)'>228</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='926.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k216&quot;, &quot;_self&quot;)'>216</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1001.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k206&quot;, &quot;_self&quot;)'>206</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1076.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k199&quot;, &quot;_self&quot;)'>199</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1151.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k194&quot;, &quot;_self&quot;)'>194</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1226.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k191&quot;, &quot;_self&quot;)'>191</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k215&quot;, &quot;_self&quot;)'>215</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k214&quot;, &quot;_self&quot;)'>214</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k205&quot;, &quot;_self&quot;)'>205</text>
  <line
   x1='289.560' y1='752.460' x2='339.480' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k198&quot;, &quot;_self&quot;)'>198</text>
  <line
   x1='239.640' y1='752.460' x2='289.560' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k193&quot;, &quot;_self&quot;)'>193</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k227&quot;, &quot;_self&quot;)'>227</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k226&quot;, &quot;_self&quot;)'>226</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k213&quot;, &quot;_self&quot;)'>213</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k204&quot;, &quot;_self&quot;)'>204</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k197&quot;, &quot;_self&quot;)'>197</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k237&quot;, &quot;_self&quot;)'>237</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k236&quot;, &quot;_self&quot;)'>236</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k225&quot;, &quot;_self&quot;)'>225</text>
  <line
   x1='389.400' y1='452.460' x2='439.320' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k212&quot;, &quot;_self&quot;)'>212</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k203&quot;, &quot;_self&quot;)'>203</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k244&quot;, &quot;_self&quot;)'>244</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k243&quot;, &quot;_self&quot;)'>243</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k235&quot;, &quot;_self&quot;)'>235</text>
  <line
   x1='439.320' y1='302.460' x2='489.240' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k224&quot;, &quot;_self&quot;)'>224</text>
  <line
   x1='389.400' y1='302.460' x2='439.320' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k211&quot;, &quot;_self&quot;)'>211</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k249&quot;, &quot;_self&quot;)'>249</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k248&quot;, &quot;_self&quot;)'>248</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k242&quot;, &quot;_self&quot;)'>242</text>
  <line
   x1='489.240' y1='152.460' x2='539.160' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k234&quot;, &quot;_self&quot;)'>234</text>
  <line
   x1='439.320' y1='152.460' x2='489.240' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k223&quot;, &quot;_self&quot;)'>223</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k222&quot;, &quot;_self&quot;)'>222</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k210&quot;, &quot;_self&quot;)'>210</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k202&quot;, &quot;_self&quot;)'>202</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k196&quot;, &quot;_self&quot;)'>196</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k192&quot;, &quot;_self&quot;)'>192</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k190&quot;, &quot;_self&quot;)'>190</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k189&quot;, &quot;_self&quot;)'>189</text>
  <line
   x1='89.880' y1='827.460' x2='139.800' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k188&quot;, &quot;_self&quot;)'>188</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k187&quot;, &quot;_self&quot;)'>187</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k187">Item <a href="#t187">187</a>, Child: <a href="#k188">188</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 187</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (u s ca name) (y rndx)
        (x expt) (ppk skey) (z strd))
      (implies
        (and (p &quot;clienta&quot; z 10)
          (p &quot;clienta&quot; &quot;cookie&quot; z
            (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
          (p &quot;clienta&quot; &quot;cr&quot; z cr) (p &quot;clienta&quot; &quot;sr&quot; z sr)
          (p &quot;clienta&quot; &quot;spk&quot; z spk) (p &quot;clienta&quot; &quot;u&quot; z u)
          (p &quot;clienta&quot; &quot;s&quot; z s) (p &quot;clienta&quot; &quot;ca&quot; z ca)
          (p &quot;clienta&quot; &quot;y&quot; z y) (p &quot;clienta&quot; &quot;x&quot; z x) (non (invk spk))
          (non (privk ca)) (non ppk) (uniq sr) (ugen y)
          (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;servera&quot; &quot;cookie&quot; z-0 cookie)
            (p &quot;servera&quot; &quot;spk&quot; z-0 spk) (p &quot;servera&quot; &quot;u&quot; z-0 u)
            (p &quot;servera&quot; &quot;s&quot; z-0 s) (p &quot;servera&quot; &quot;ca&quot; z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 187)
  (unrealized (0 1) (0 3) (0 5))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k188">Item <a href="#t187">188</a>, Parent: <a href="#k187">187</a>, Child: <a href="#k189">189</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 188</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 188)
  (parent 187)
  (unrealized (0 1) (0 3) (0 5))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k189">Item <a href="#t187">189</a>, Parent: <a href="#k188">188</a>, Children: <a href="#k190">190</a> <a href="#k191">191</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 189</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 189)
  (parent 188)
  (unrealized (0 1) (0 3) (0 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k190">Item <a href="#t187">190</a>, Parent: <a href="#k189">189</a>, Children: <a href="#k192">192</a> <a href="#k193">193</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 190</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 190)
  (parent 189)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k191">Item <a href="#t187">191</a>, Parent: <a href="#k189">189</a>, Children: <a href="#k194">194</a> <a href="#k195">195</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 191</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 191)
  (parent 189)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k192">Item <a href="#t187">192</a>, Parent: <a href="#k190">190</a>, Children: <a href="#k196">196</a> <a href="#k197">197</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 192</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 192)
  (parent 190)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k193">Item <a href="#t187">193</a>, Parent: <a href="#k190">190</a>, Child: <a href="#k198">198</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 193</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 193)
  (parent 190)
  (unrealized (0 3) (0 5) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k194">Item <a href="#t187">194</a>, Parent: <a href="#k191">191</a>, Children: <a href="#k199">199</a> <a href="#k200">200</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 194</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 194)
  (parent 191)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k195">Item <a href="#t187">195</a>, Parent: <a href="#k191">191</a>, Child: <a href="#k201">201</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 195</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 195)
  (parent 191)
  (unrealized (0 3) (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k196">Item <a href="#t187">196</a>, Parent: <a href="#k192">192</a>, Children: <a href="#k202">202</a> <a href="#k203">203</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 196</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 196)
  (parent 192)
  (unrealized (0 9) (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k197">Item <a href="#t187">197</a>, Parent: <a href="#k192">192</a>, Child: <a href="#k204">204</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.320 375.660 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 197</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 197)
  (parent 192)
  (unrealized (0 5) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k198">Item <a href="#t187">198</a>, Parent: <a href="#k193">193</a>, Child: <a href="#k205">205</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 198</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 198)
  (parent 193)
  (unrealized (0 3) (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k199">Item <a href="#t187">199</a>, Parent: <a href="#k194">194</a>, Children: <a href="#k206">206</a> <a href="#k207">207</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 199</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-1)) cr sr)))
      (hash (hash (exp (gen) (mul y x-1)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 199)
  (parent 194)
  (unrealized (0 9) (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k200">Item <a href="#t187">200</a>, Parent: <a href="#k194">194</a>, Child: <a href="#k208">208</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.583 376.118 45.326 487.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 200</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 200)
  (parent 194)
  (unrealized (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k201">Item <a href="#t187">201</a>, Parent: <a href="#k195">195</a>, Child: <a href="#k209">209</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 201</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 201)
  (parent 195)
  (unrealized (0 3) (0 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k202">Item <a href="#t187">202</a>, Parent: <a href="#k196">196</a>, Children: <a href="#k210">210</a> <a href="#k211">211</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 202</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))))
  (label 202)
  (parent 196)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k203">Item <a href="#t187">203</a>, Parent: <a href="#k196">196</a>, Child: <a href="#k212">212</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 203</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 203)
  (parent 196)
  (unrealized (0 9) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k204">Item <a href="#t187">204</a>, Parent: <a href="#k197">197</a>, Child: <a href="#k213">213</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.729 413.906 45.578 487.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 204</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 204)
  (parent 197)
  (unrealized (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k205">Item <a href="#t187">205</a>, Parent: <a href="#k198">198</a>, Children: <a href="#k214">214</a> <a href="#k215">215</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 205</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 205)
  (parent 198)
  (unrealized (0 5) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k206">Item <a href="#t187">206</a>, Parent: <a href="#k199">199</a>, Children: <a href="#k216">216</a> <a href="#k217">217</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 206</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))))
  (label 206)
  (parent 199)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k207">Item <a href="#t187">207</a>, Parent: <a href="#k199">199</a>, Child: <a href="#k218">218</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 207</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 207)
  (parent 199)
  (unrealized (0 9) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k208">Item <a href="#t187">208</a>, Parent: <a href="#k200">200</a>, Child: <a href="#k219">219</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.810 414.232 45.781 488.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 208</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 208)
  (parent 200)
  (unrealized (0 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k209">Item <a href="#t187">209</a>, Parent: <a href="#k201">201</a>, Children: <a href="#k220">220</a> <a href="#k221">221</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 209</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 209)
  (parent 201)
  (unrealized (0 5) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k210">Item <a href="#t187">210</a>, Parent: <a href="#k202">202</a>, Children: <a href="#k222">222</a> <a href="#k223">223</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 210</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 210)
  (parent 202)
  (unrealized (1 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k211">Item <a href="#t187">211</a>, Parent: <a href="#k202">202</a>, Child: <a href="#k224">224</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 141.138 524.718 42.396 784.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 211</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
  (label 211)
  (parent 202)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k212">Item <a href="#t187">212</a>, Parent: <a href="#k203">203</a>, Child: <a href="#k225">225</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 212</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 212)
  (parent 203)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k213">Item <a href="#t187">213</a>, Parent: <a href="#k204">204</a>, Children: <a href="#k226">226</a> <a href="#k227">227</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 213</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 213)
  (parent 204)
  (unrealized (0 5) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k214">Item <a href="#t187">214</a>, Parent: <a href="#k205">205</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 214</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 214)
  (parent 205)
  (unrealized (0 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k215">Item <a href="#t187">215</a>, Parent: <a href="#k205">205</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 215</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 215)
  (parent 205)
  (unrealized (0 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k216">Item <a href="#t187">216</a>, Parent: <a href="#k206">206</a>, Children: <a href="#k228">228</a> <a href="#k229">229</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 216</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 216)
  (parent 206)
  (unrealized (2 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k217">Item <a href="#t187">217</a>, Parent: <a href="#k206">206</a>, Child: <a href="#k230">230</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 191.564 524.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 217</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
  (label 217)
  (parent 206)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k218">Item <a href="#t187">218</a>, Parent: <a href="#k207">207</a>, Child: <a href="#k231">231</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 218</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 218)
  (parent 207)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k219">Item <a href="#t187">219</a>, Parent: <a href="#k208">208</a>, Children: <a href="#k232">232</a> <a href="#k233">233</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 219</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 219)
  (parent 208)
  (unrealized (0 5) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k220">Item <a href="#t187">220</a>, Parent: <a href="#k209">209</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 220</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 220)
  (parent 209)
  (unrealized (0 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k221">Item <a href="#t187">221</a>, Parent: <a href="#k209">209</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 221</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 221)
  (parent 209)
  (unrealized (0 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k222">Item <a href="#t187">222</a>, Parent: <a href="#k210">210</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 222</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))))
  (label 222)
  (parent 210)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
        (y y) (x x) (ppk ppk) (p p) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (sr (1 1))
    (cr (0 0))))</pre>

<p id="k223">Item <a href="#t187">223</a>, Parent: <a href="#k210">210</a>, Child: <a href="#k234">234</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 190.673 524.561 141.465 709.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 223</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 223)
  (parent 210)
  (unrealized (1 8) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k224">Item <a href="#t187">224</a>, Parent: <a href="#k211">211</a>, Child: <a href="#k235">235</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.331 562.313 42.783 784.665'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 224</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
  (label 224)
  (parent 211)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k225">Item <a href="#t187">225</a>, Parent: <a href="#k212">212</a>, Children: <a href="#k236">236</a> <a href="#k237">237</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 87.540 300.660 135.121 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 225</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 225)
  (parent 212)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k226">Item <a href="#t187">226</a>, Parent: <a href="#k213">213</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 226</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 226)
  (parent 213)
  (unrealized (0 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k227">Item <a href="#t187">227</a>, Parent: <a href="#k213">213</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 227</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 227)
  (parent 213)
  (unrealized (0 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k228">Item <a href="#t187">228</a>, Parent: <a href="#k216">216</a>, Seen Child: <a href="#k222">222</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 228</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))))
  (label 228)
  (parent 216)
  (seen 222)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k229">Item <a href="#t187">229</a>, Parent: <a href="#k216">216</a>, Child: <a href="#k238">238</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 290.633 524.561 241.425 709.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 229</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 229)
  (parent 216)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k230">Item <a href="#t187">230</a>, Parent: <a href="#k217">217</a>, Child: <a href="#k239">239</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 191.774 562.617 43.707 785.274'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 230</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
  (label 230)
  (parent 217)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k231">Item <a href="#t187">231</a>, Parent: <a href="#k218">218</a>, Children: <a href="#k240">240</a> <a href="#k241">241</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 231</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 231)
  (parent 218)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k232">Item <a href="#t187">232</a>, Parent: <a href="#k219">219</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 232</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 232)
  (parent 219)
  (unrealized (0 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k233">Item <a href="#t187">233</a>, Parent: <a href="#k219">219</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 233</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 233)
  (parent 219)
  (unrealized (0 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k234">Item <a href="#t187">234</a>, Parent: <a href="#k223">223</a>, Child: <a href="#k242">242</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 190.848 562.114 141.817 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 234</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
  (label 234)
  (parent 223)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k235">Item <a href="#t187">235</a>, Parent: <a href="#k224">224</a>, Children: <a href="#k243">243</a> <a href="#k244">244</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.584 599.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 235</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 235)
  (parent 224)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k236">Item <a href="#t187">236</a>, Parent: <a href="#k225">225</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 88.276 337.464 136.593 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 236</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 236)
  (parent 225)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k237">Item <a href="#t187">237</a>, Parent: <a href="#k225">225</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 88.276 337.464 136.593 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 237</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 237)
  (parent 225)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k238">Item <a href="#t187">238</a>, Parent: <a href="#k229">229</a>, Child: <a href="#k245">245</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 290.808 562.114 241.777 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 238</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))))
  (label 238)
  (parent 229)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k239">Item <a href="#t187">239</a>, Parent: <a href="#k230">230</a>, Children: <a href="#k246">246</a> <a href="#k247">247</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 239</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 239)
  (parent 230)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k240">Item <a href="#t187">240</a>, Parent: <a href="#k231">231</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 240</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 240)
  (parent 231)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k241">Item <a href="#t187">241</a>, Parent: <a href="#k231">231</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 241</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 241)
  (parent 231)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k242">Item <a href="#t187">242</a>, Parent: <a href="#k234">234</a>, Children: <a href="#k248">248</a> <a href="#k249">249</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.118 599.718 142.356 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 242</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 242)
  (parent 234)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k243">Item <a href="#t187">243</a>, Parent: <a href="#k235">235</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 243</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 243)
  (parent 235)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k244">Item <a href="#t187">244</a>, Parent: <a href="#k235">235</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) request (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 244</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 244)
  (parent 235)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k245">Item <a href="#t187">245</a>, Parent: <a href="#k238">238</a>, Children: <a href="#k250">250</a> <a href="#k251">251</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.078 599.718 242.316 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 245</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 245)
  (parent 238)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k246">Item <a href="#t187">246</a>, Parent: <a href="#k239">239</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 246</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 246)
  (parent 239)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k247">Item <a href="#t187">247</a>, Parent: <a href="#k239">239</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) request (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 247</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 247)
  (parent 239)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k248">Item <a href="#t187">248</a>, Parent: <a href="#k242">242</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 191.564 637.464 143.247 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 248</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 248)
  (parent 242)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k249">Item <a href="#t187">249</a>, Parent: <a href="#k242">242</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 191.564 637.464 143.247 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 249</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 249)
  (parent 242)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k250">Item <a href="#t187">250</a>, Parent: <a href="#k245">245</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 291.524 637.464 243.207 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 250</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 250)
  (parent 245)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k251">Item <a href="#t187">251</a>, Parent: <a href="#k245">245</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 291.524 637.464 243.207 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request-0 (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 251</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 251)
  (parent 245)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t252">Tree <a href="#top">252</a>, POV <a href="#k252">252</a>.</p>

<div>
 <svg
  class='diagram' width='579.120pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.120 904.920' font-size='12.000'>
  <text
   x='389.400' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k278&quot;, &quot;_self&quot;)'>278</text>
  <line
   x1='339.480' y1='827.460' x2='389.400' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k277&quot;, &quot;_self&quot;)'>277</text>
  <line
   x1='339.480' y1='827.460' x2='389.400' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='813.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k270&quot;, &quot;_self&quot;)'>270</text>
  <line
   x1='289.560' y1='827.460' x2='339.480' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='813.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k264&quot;, &quot;_self&quot;)'>264</text>
  <line
   x1='239.640' y1='827.460' x2='289.560' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='813.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k260&quot;, &quot;_self&quot;)'>260</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k288&quot;, &quot;_self&quot;)'>288</text>
  <line
   x1='439.320' y1='677.460' x2='489.240' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k287&quot;, &quot;_self&quot;)'>287</text>
  <line
   x1='439.320' y1='677.460' x2='489.240' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k282&quot;, &quot;_self&quot;)'>282</text>
  <line
   x1='389.400' y1='677.460' x2='439.320' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k276&quot;, &quot;_self&quot;)'>276</text>
  <line
   x1='339.480' y1='677.460' x2='389.400' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k269&quot;, &quot;_self&quot;)'>269</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k292&quot;, &quot;_self&quot;)'>292</text>
  <line
   x1='489.240' y1='527.460' x2='539.160' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k291&quot;, &quot;_self&quot;)'>291</text>
  <line
   x1='489.240' y1='527.460' x2='539.160' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k286&quot;, &quot;_self&quot;)'>286</text>
  <line
   x1='439.320' y1='527.460' x2='489.240' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k281&quot;, &quot;_self&quot;)'>281</text>
  <line
   x1='389.400' y1='527.460' x2='439.320' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k275&quot;, &quot;_self&quot;)'>275</text>
  <line
   x1='339.480' y1='527.460' x2='389.400' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k268&quot;, &quot;_self&quot;)'>268</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k263&quot;, &quot;_self&quot;)'>263</text>
  <line
   x1='239.640' y1='602.460' x2='289.560' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k259&quot;, &quot;_self&quot;)'>259</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k256&quot;, &quot;_self&quot;)'>256</text>
  <line
   x1='139.800' y1='452.460' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k274&quot;, &quot;_self&quot;)'>274</text>
  <line
   x1='339.480' y1='377.460' x2='389.400' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k273&quot;, &quot;_self&quot;)'>273</text>
  <line
   x1='339.480' y1='377.460' x2='389.400' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k267&quot;, &quot;_self&quot;)'>267</text>
  <line
   x1='289.560' y1='377.460' x2='339.480' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k262&quot;, &quot;_self&quot;)'>262</text>
  <line
   x1='239.640' y1='377.460' x2='289.560' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k258&quot;, &quot;_self&quot;)'>258</text>
  <line
   x1='189.720' y1='227.460' x2='239.640' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k285&quot;, &quot;_self&quot;)'>285</text>
  <line
   x1='439.320' y1='227.460' x2='489.240' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k284&quot;, &quot;_self&quot;)'>284</text>
  <line
   x1='439.320' y1='227.460' x2='489.240' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k280&quot;, &quot;_self&quot;)'>280</text>
  <line
   x1='389.400' y1='227.460' x2='439.320' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k272&quot;, &quot;_self&quot;)'>272</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k266&quot;, &quot;_self&quot;)'>266</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k290&quot;, &quot;_self&quot;)'>290</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k289&quot;, &quot;_self&quot;)'>289</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k283&quot;, &quot;_self&quot;)'>283</text>
  <line
   x1='439.320' y1='77.460' x2='489.240' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k279&quot;, &quot;_self&quot;)'>279</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k271&quot;, &quot;_self&quot;)'>271</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k265&quot;, &quot;_self&quot;)'>265</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k261&quot;, &quot;_self&quot;)'>261</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k257&quot;, &quot;_self&quot;)'>257</text>
  <line
   x1='189.720' y1='227.460' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k255&quot;, &quot;_self&quot;)'>255</text>
  <line
   x1='139.800' y1='452.460' x2='189.720' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k254&quot;, &quot;_self&quot;)'>254</text>
  <line
   x1='89.880' y1='452.460' x2='139.800' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k253&quot;, &quot;_self&quot;)'>253</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k252&quot;, &quot;_self&quot;)'>252</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k252">Item <a href="#t252">252</a>, Child: <a href="#k253">253</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 252</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (s ca u name) (y rndx)
        (x expt) (ppk skey) (z strd))
      (implies
        (and (p &quot;clientr&quot; z 7)
          (p &quot;clientr&quot; &quot;cookie&quot; z
            (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
          (p &quot;clientr&quot; &quot;cr&quot; z cr) (p &quot;clientr&quot; &quot;sr&quot; z sr)
          (p &quot;clientr&quot; &quot;spk&quot; z spk) (p &quot;clientr&quot; &quot;u&quot; z u)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;ca&quot; z ca)
          (p &quot;clientr&quot; &quot;y&quot; z y) (p &quot;clientr&quot; &quot;x&quot; z x) (non (invk spk))
          (non (privk ca)) (uniq sr) (ugen y) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;servera&quot; &quot;cookie&quot; z-0 cookie)
            (p &quot;servera&quot; &quot;spk&quot; z-0 spk) (p &quot;servera&quot; &quot;u&quot; z-0 u)
            (p &quot;servera&quot; &quot;s&quot; z-0 s) (p &quot;servera&quot; &quot;ca&quot; z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 252)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k253">Item <a href="#t252">253</a>, Parent: <a href="#k252">252</a>, Child: <a href="#k254">254</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 253</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 253)
  (parent 252)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k254">Item <a href="#t252">254</a>, Parent: <a href="#k253">253</a>, Children: <a href="#k255">255</a> <a href="#k256">256</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 254</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (s ca u name)
    (pt pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 254)
  (parent 253)
  (unrealized (0 1) (0 3) (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k255">Item <a href="#t252">255</a>, Parent: <a href="#k254">254</a>, Children: <a href="#k257">257</a> <a href="#k258">258</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 255</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 255)
  (parent 254)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k256">Item <a href="#t252">256</a>, Parent: <a href="#k254">254</a>, Children: <a href="#k259">259</a> <a href="#k260">260</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 256</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 256)
  (parent 254)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k257">Item <a href="#t252">257</a>, Parent: <a href="#k255">255</a>, Child: <a href="#k261">261</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 257</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))))
  (label 257)
  (parent 255)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k258">Item <a href="#t252">258</a>, Parent: <a href="#k255">255</a>, Child: <a href="#k262">262</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 258</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 258)
  (parent 255)
  (unrealized (0 3) (0 4) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k259">Item <a href="#t252">259</a>, Parent: <a href="#k256">256</a>, Child: <a href="#k263">263</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 259</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (s ca u name)
    (pt pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))))
  (label 259)
  (parent 256)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k260">Item <a href="#t252">260</a>, Parent: <a href="#k256">256</a>, Child: <a href="#k264">264</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 260</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (enc
      (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 260)
  (parent 256)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k261">Item <a href="#t252">261</a>, Parent: <a href="#k257">257</a>, Children: <a href="#k265">265</a> <a href="#k266">266</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 137.927 337.717 235.895 485.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 261</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 5)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
    (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))))
  (label 261)
  (parent 257)
  (unrealized (0 6) (2 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k262">Item <a href="#t252">262</a>, Parent: <a href="#k258">258</a>, Child: <a href="#k267">267</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 262</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
  (label 262)
  (parent 258)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k263">Item <a href="#t252">263</a>, Parent: <a href="#k259">259</a>, Children: <a href="#k268">268</a> <a href="#k269">269</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 187.500 338.160 335.041 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 263</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 5)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
    (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))))
  (label 263)
  (parent 259)
  (unrealized (0 6) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k264">Item <a href="#t252">264</a>, Parent: <a href="#k260">260</a>, Child: <a href="#k270">270</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 264</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
  (label 264)
  (parent 260)
  (unrealized (0 3) (0 4) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k265">Item <a href="#t252">265</a>, Parent: <a href="#k261">261</a>, Child: <a href="#k271">271</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 265</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (1 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 servera 6)
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
    (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;)))))
  (label 265)
  (parent 261)
  (unrealized (0 6) (1 5) (2 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k266">Item <a href="#t252">266</a>, Parent: <a href="#k261">261</a>, Child: <a href="#k272">272</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 291.524 412.464 243.207 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 266</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (label 266)
  (parent 261)
  (unrealized (0 6) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k267">Item <a href="#t252">267</a>, Parent: <a href="#k262">262</a>, Children: <a href="#k273">273</a> <a href="#k274">274</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 267</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 267)
  (parent 262)
  (unrealized (0 4) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k268">Item <a href="#t252">268</a>, Parent: <a href="#k263">263</a>, Child: <a href="#k275">275</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 268</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 servera 6)
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-2)) cr sr)))
    (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;)))))
  (label 268)
  (parent 263)
  (unrealized (0 6) (2 5) (3 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k269">Item <a href="#t252">269</a>, Parent: <a href="#k263">263</a>, Child: <a href="#k276">276</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 391.484 412.464 343.167 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 269</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (label 269)
  (parent 263)
  (unrealized (0 6) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k270">Item <a href="#t252">270</a>, Parent: <a href="#k264">264</a>, Children: <a href="#k277">277</a> <a href="#k278">278</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 270</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 270)
  (parent 264)
  (unrealized (0 4) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k271">Item <a href="#t252">271</a>, Parent: <a href="#k265">265</a>, Child: <a href="#k279">279</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 271</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 271)
  (parent 265)
  (unrealized (0 6) (1 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k272">Item <a href="#t252">272</a>, Parent: <a href="#k266">266</a>, Child: <a href="#k280">280</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.260 450.660 244.679 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 272</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
    (hash ppk (hash (exp (gen) (mul y x)) cr sr)) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (label 272)
  (parent 266)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k273">Item <a href="#t252">273</a>, Parent: <a href="#k267">267</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 273</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 273)
  (parent 267)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k274">Item <a href="#t252">274</a>, Parent: <a href="#k267">267</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 274</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 274)
  (parent 267)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k275">Item <a href="#t252">275</a>, Parent: <a href="#k268">268</a>, Child: <a href="#k281">281</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 275</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 275)
  (parent 268)
  (unrealized (0 6) (2 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k276">Item <a href="#t252">276</a>, Parent: <a href="#k269">269</a>, Child: <a href="#k282">282</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.220 450.660 344.639 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 276</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
    (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (label 276)
  (parent 269)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k277">Item <a href="#t252">277</a>, Parent: <a href="#k270">270</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 277</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 277)
  (parent 270)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k278">Item <a href="#t252">278</a>, Parent: <a href="#k270">270</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 278</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 278)
  (parent 270)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k279">Item <a href="#t252">279</a>, Parent: <a href="#k271">271</a>, Child: <a href="#k283">283</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 279</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))))
  (label 279)
  (parent 271)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k280">Item <a href="#t252">280</a>, Parent: <a href="#k272">272</a>, Children: <a href="#k284">284</a> <a href="#k285">285</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 280</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 280)
  (parent 272)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k281">Item <a href="#t252">281</a>, Parent: <a href="#k275">275</a>, Child: <a href="#k286">286</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 281</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))))
  (label 281)
  (parent 275)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k282">Item <a href="#t252">282</a>, Parent: <a href="#k276">276</a>, Children: <a href="#k287">287</a> <a href="#k288">288</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 282</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 282)
  (parent 276)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k283">Item <a href="#t252">283</a>, Parent: <a href="#k279">279</a>, Children: <a href="#k289">289</a> <a href="#k290">290</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.913 487.717 43.945 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 283</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 283)
  (parent 279)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k284">Item <a href="#t252">284</a>, Parent: <a href="#k280">280</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 90.888 487.114 41.857 634.268'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 284</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 284)
  (parent 280)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k285">Item <a href="#t252">285</a>, Parent: <a href="#k280">280</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x)) cr sr))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 90.888 487.114 41.857 634.268'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) request (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr sr (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 285</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 285)
  (parent 280)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k286">Item <a href="#t252">286</a>, Parent: <a href="#k281">281</a>, Children: <a href="#k291">291</a> <a href="#k292">292</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.300 488.160 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 286</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 286)
  (parent 281)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k287">Item <a href="#t252">287</a>, Parent: <a href="#k282">282</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 192.900 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.584 449.964 43.287 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 287</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 287)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k288">Item <a href="#t252">288</a>, Parent: <a href="#k282">282</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(cat ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(hash ppk (hash (exp (gen) (mul y x-0)) cr sr))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 192.900 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.584 449.964 43.287 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) request (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr sr (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0) (y y))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 288</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 288)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k289">Item <a href="#t252">289</a>, Parent: <a href="#k283">283</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 192.900 639.960 145.920 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='264.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 289</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 289)
  (parent 283)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k290">Item <a href="#t252">290</a>, Parent: <a href="#k283">283</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) cr sr)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 192.900 639.960 145.920 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x)) &quot;server finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x)) &quot;client finished&quot; (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='264.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.520 300.660 235.081 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-0) (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 290</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) &quot;client finished&quot;
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) &quot;server finished&quot;
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 290)
  (parent 283)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k291">Item <a href="#t252">291</a>, Parent: <a href="#k286">286</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-1)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.860 639.960 245.880 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 291</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 291)
  (parent 286)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k292">Item <a href="#t252">292</a>, Parent: <a href="#k286">286</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) y-0)</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-1)) cr sr)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.860 639.960 245.880 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y x-0)) &quot;server finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) y) (enc (hash (exp (gen) (mul y x-0)) &quot;client finished&quot; (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca))) (cat (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))) (exp (gen) y))) (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x-0) (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x) (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 187.217 301.118 334.474 412.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) y-0) (enc (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot; (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (cat (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))) (exp (gen) y-0))) (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (exp (gen) x-1) (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))) (response response) (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 292</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              &quot;client_write&quot;))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) &quot;server finished&quot;
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            &quot;server_write&quot;))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              &quot;client_write&quot;))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) &quot;server finished&quot;
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) &quot;client finished&quot;
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  &quot;client_write&quot;))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            &quot;server_write&quot;))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) &quot;client_write&quot;)))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 292)
  (parent 286)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
