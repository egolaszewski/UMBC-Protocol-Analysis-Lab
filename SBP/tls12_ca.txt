(herald "Cookie Authentication with TLS 1.2" (bound 12))

(comment "CPSA 4.4.2")
(comment "All input read from tls12_ca.scm")
(comment "Strand count bounded at 12")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 0)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 2)
  (parent 1)
  (unrealized (0 3) (0 5) (0 9))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 3)
  (parent 2)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 4)
  (parent 2)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 5)
  (parent 2)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 6)
  (parent 3)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 7)
  (parent 3)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 8)
  (parent 4)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 9)
  (parent 4)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 10)
  (parent 5)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 11)
  (parent 6)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 12)
  (parent 6)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 13)
  (parent 7)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 14)
  (parent 8)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 15)
  (parent 8)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 16)
  (parent 9)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 17)
  (parent 10)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 18)
  (parent 11)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 19)
  (parent 11)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 20)
  (parent 12)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 22)
  (parent 14)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 23)
  (parent 14)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 24)
  (parent 15)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 25)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 26)
  (parent 18)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (pms pms)
        (cookie cookie) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (cr (0 0)) (pms (0 2))
    (sr (1 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 27)
  (parent 18)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 28)
  (parent 19)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 29)
  (parent 20)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 30)
  (parent 22)
  (seen 26)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 31)
  (parent 22)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 32)
  (parent 23)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 33)
  (parent 24)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8))
    ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 34)
  (parent 27)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 35)
  (parent 28)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 36)
  (parent 31)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 37)
  (parent 32)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 38)
  (parent 34)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 39)
  (parent 36)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 40)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 41)
  (parent 40)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((2 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 42)
  (parent 41)
  (unrealized (0 3) (0 5) (0 9))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 43)
  (parent 42)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 44)
  (parent 42)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((2 1) (0 1)) ((3 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 45)
  (parent 42)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 46)
  (parent 43)
  (unrealized (0 9) (1 0) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((3 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 47)
  (parent 43)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 48)
  (parent 44)
  (unrealized (0 9) (1 0) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((4 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 49)
  (parent 44)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((2 1) (0 1)) ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 50)
  (parent 45)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 51)
  (parent 46)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 52)
  (parent 46)
  (unrealized (0 9) (1 0) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 53)
  (parent 47)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 54)
  (parent 48)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 55)
  (parent 48)
  (unrealized (0 9) (1 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 56)
  (parent 49)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 57)
  (parent 50)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 3 0 clienta 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 58)
  (parent 51)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 59)
  (parent 51)
  (seen 70)
  (unrealized (0 9) (1 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 60)
  (parent 51)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 61)
  (parent 52)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 62)
  (parent 53)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 4 0 clienta 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 63)
  (parent 54)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 64)
  (parent 54)
  (seen 77)
  (unrealized (0 9) (1 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 65)
  (parent 54)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 66)
  (parent 55)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 67)
  (parent 56)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 68)
  (parent 58)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 3 0 clienta 9) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 69)
  (parent 58)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 70)
  (parent 58)
  (seen 84)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 71)
  (parent 58)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)) ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 72)
  (parent 59)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (1 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 73)
  (parent 60)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 74)
  (parent 61)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 75)
  (parent 63)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 4 0 clienta 9) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 76)
  (parent 63)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 77)
  (parent 63)
  (seen 95)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 78)
  (parent 63)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0))
    ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 79)
  (parent 64)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 80)
  (parent 65)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 81)
  (parent 66)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 82)
  (parent 68)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 5) (1 0))
    ((4 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 83)
  (parent 68)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 84)
  (parent 69)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 85)
  (parent 69)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 86)
  (parent 69)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 87)
  (parent 69)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 88)
  (parent 70)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 89)
  (parent 70)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 90)
  (parent 71)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)) ((3 1) (1 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 91)
  (parent 72)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 92)
  (parent 73)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 93)
  (parent 75)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 94)
  (parent 75)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 95)
  (parent 76)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 96)
  (parent 76)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 97)
  (parent 76)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 98)
  (parent 76)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 99)
  (parent 77)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 100)
  (parent 77)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 101)
  (parent 78)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0))
    ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 102)
  (parent 79)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 103)
  (parent 80)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 104)
  (parent 82)
  (realized)
  (shape)
  (maps
    ((0 1)
      ((u u) (s s) (ca ca-0) (p p) (cr cr) (sr sr) (pms pms)
        (cookie cookie) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (3 5)) (pt-2 (3 7)) (cr (0 0)) (pms (0 2))
    (sr (3 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 105)
  (parent 82)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 5) (1 0))
    ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 106)
  (parent 83)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 107)
  (parent 84)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 108)
  (parent 84)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 109)
  (parent 84)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 110)
  (parent 85)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 111)
  (parent 85)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 112)
  (parent 86)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (1 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 113)
  (parent 87)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 114)
  (parent 88)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 115)
  (parent 88)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 116)
  (parent 89)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 117)
  (parent 90)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 118)
  (parent 91)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 119)
  (parent 93)
  (seen 104)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 120)
  (parent 93)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 121)
  (parent 94)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 122)
  (parent 95)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 123)
  (parent 95)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 124)
  (parent 95)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 125)
  (parent 96)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 126)
  (parent 96)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 127)
  (parent 97)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 128)
  (parent 98)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 129)
  (parent 99)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 130)
  (parent 99)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 131)
  (parent 100)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 132)
  (parent 101)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 133)
  (parent 102)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 134)
  (parent 105)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 135)
  (parent 106)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 136)
  (parent 107)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 137)
  (parent 107)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 138)
  (parent 108)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 139)
  (parent 109)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 140)
  (parent 110)
  (seen 104)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 141)
  (parent 110)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 142)
  (parent 111)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 143)
  (parent 112)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 144)
  (parent 113)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 145)
  (parent 114)
  (seen 104)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 146)
  (parent 114)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 147)
  (parent 115)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 148)
  (parent 116)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 149)
  (parent 120)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 150)
  (parent 121)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 151)
  (parent 122)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 152)
  (parent 122)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 153)
  (parent 123)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 154)
  (parent 124)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 155)
  (parent 125)
  (seen 140)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 156)
  (parent 125)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 157)
  (parent 126)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 158)
  (parent 127)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 159)
  (parent 128)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 160)
  (parent 129)
  (seen 145)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)) ((5 1) (4 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 161)
  (parent 129)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 162)
  (parent 130)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 163)
  (parent 131)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 164)
  (parent 134)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 165)
  (parent 136)
  (seen 145)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 166)
  (parent 136)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 167)
  (parent 137)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 168)
  (parent 138)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 169)
  (parent 139)
  (unrealized (0 9) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 170)
  (parent 141)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 171)
  (parent 142)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 172)
  (parent 146)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 173)
  (parent 147)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 174)
  (parent 149)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 175)
  (parent 151)
  (seen 165)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-1 (hash (hash pms cr sr) "client_write")) (4 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 176)
  (parent 151)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 177)
  (parent 152)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 178)
  (parent 153)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 179)
  (parent 154)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 180)
  (parent 156)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 181)
  (parent 157)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 182)
  (parent 161)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 183)
  (parent 162)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 184)
  (parent 166)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 185)
  (parent 167)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 186)
  (parent 170)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 187)
  (parent 172)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 188)
  (parent 176)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 189)
  (parent 177)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 190)
  (parent 180)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 191)
  (parent 182)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 192)
  (parent 184)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (privk s) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (6 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 193)
  (parent 188)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 194)
  (unrealized (0 1) (0 3) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 195)
  (parent 194)
  (unrealized (0 1) (0 3) (0 4) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 196)
  (parent 195)
  (unrealized (0 3) (0 4) (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 197)
  (parent 196)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 198)
  (parent 196)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 199)
  (parent 196)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 200)
  (parent 197)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 201)
  (parent 198)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 202)
  (parent 199)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 203)
  (parent 200)
  (unrealized (2 4) (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 204)
  (parent 200)
  (unrealized (2 4) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 205)
  (parent 200)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 206)
  (parent 201)
  (unrealized (3 4) (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 207)
  (parent 201)
  (unrealized (3 4) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 208)
  (parent 201)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 209)
  (parent 202)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 210)
  (parent 203)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 211)
  (parent 204)
  (unrealized (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 212)
  (parent 204)
  (unrealized (2 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 213)
  (parent 205)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 214)
  (parent 206)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 215)
  (parent 207)
  (unrealized (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 216)
  (parent 207)
  (unrealized (3 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 217)
  (parent 208)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 218)
  (parent 210)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 219)
  (parent 211)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca-0) (cr cr) (sr sr) (pms pms) (u u) (cookie cookie)
        (cookiestor cookiestor) (request request) (response response))))
  (origs (cookie (3 5)) (pt-1 (3 7)) (pt (1 7)) (cr (0 0)) (pms (0 2))
    (sr (2 1))))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 220)
  (parent 212)
  (unrealized (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 221)
  (parent 213)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 222)
  (parent 214)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 223)
  (parent 215)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-2)
      (send (cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-2 sr-2
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-2 sr-2) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-2 sr-2
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-2 sr-2
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-2 sr-2) "client_write"))))
          (hash (hash pms-1 cr-2 sr-2) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-2 sr-2) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-2 sr-2) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 224)
  (parent 215)
  (seen 219)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 225)
  (parent 216)
  (unrealized (3 5) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 226)
  (parent 217)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 227)
  (parent 218)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 228)
  (parent 220)
  (unrealized (2 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 229)
  (parent 222)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 2))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 1)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 230)
  (parent 223)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 231)
  (parent 225)
  (unrealized (3 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 3))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (2 2)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 232)
  (parent 230)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 3)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 233)
  (parent 232)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0) (privk ca-1))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated ca-1)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 234)
  (parent 233)
  (seen 219)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (s ca u name) (pt pt-0 pval)
    (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie sr)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request (hash (hash pms cr sr) "client_write")))))
  (label 235)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (s ca u name) (pt pt-0 pval)
    (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie sr)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request (hash (hash pms cr sr) "client_write")))))
  (label 236)
  (parent 235)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (pms pms) (cookie cookie) (u u)
        (p p) (any any) (authstor authstor) (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (s ca u name) (pt pt-0 pval)
    (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request (hash (hash pms cr sr) "client_write")))))
  (label 237)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (s ca u name) (pt pt-0 pval)
    (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request (hash (hash pms cr sr) "client_write")))))
  (label 238)
  (parent 237)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (pms pms) (cookie cookie) (u u)
        (p p) (any any) (authstor authstor) (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (pms random48)
    (s ca u name) (pt pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig sr)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 239)
  (realized)
  (origs (sr (0 1)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (pms random48)
    (s ca u name) (pt pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig (privk s) (privk ca))
  (uniq-orig sr)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 240)
  (parent 239)
  (unrealized (0 5))
  (origs (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (s ca u ca-0 name)
    (pt pt-0 pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (authstor authstor))
  (defstrand servera 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (authstor authstor))
  (precedes ((1 5) (0 4)) ((1 7) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie sr)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (leads-to ((1 7) (0 5)))
  (rule fact-serverr-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt "server store" s u cookie)) (0 5))
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie)))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (send
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (recv
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load authstor (cat pt-0 any))
      (stor authstor (cat pt "server store" s u cookie))))
  (label 241)
  (parent 240)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (pms pms) (u u) (cookie cookie)
        (authstor authstor) (request request))))
  (origs (cookie (1 5)) (pt (1 7)) (sr (0 1))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((any mesg) (cookie data) (response httpdata) (request httpreq)
        (p password) (cr sr random32) (pms random48) (u s ca name)
        (cookiestor locn) (z z-0 strd))
      (implies
        (and (p "clienta" z 10) (p "" z-0 2) (p "clienta" "any" z any)
          (p "clienta" "cookie" z cookie)
          (p "clienta" "response" z response)
          (p "clienta" "request" z request) (p "clienta" "p" z p)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "pms" z pms) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "cookiestor" z cookiestor) (p "" "x" z-0 cookie)
          (non (privk s)) (non (privk ca)) (pnon p) (uniq sr)
          (uniq-at cr z 0) (uniq-at pms z 2)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 242)
  (unrealized (1 1) (1 3) (1 5) (1 9))
  (origs (pt-0 (1 7)) (cr (1 0)) (pms (1 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 243)
  (parent 242)
  (unrealized (1 1) (1 3) (1 5) (1 9))
  (origs (pt-0 (1 7)) (cr (1 0)) (pms (1 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((2 1) (1 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 244)
  (parent 243)
  (unrealized (1 3) (1 5) (1 9))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 245)
  (parent 244)
  (unrealized (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 246)
  (parent 244)
  (unrealized (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((2 1) (1 1)) ((3 1) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 247)
  (parent 244)
  (unrealized (1 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (0 0)) ((2 5) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 248)
  (parent 245)
  (unrealized (0 0) (1 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((3 1) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 249)
  (parent 245)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 250)
  (parent 246)
  (unrealized (0 0) (1 9) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((4 1) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 251)
  (parent 246)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((2 1) (1 1)) ((3 1) (1 3)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 252)
  (parent 247)
  (unrealized (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 1 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 253)
  (parent 248)
  (unrealized (0 0) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 254)
  (parent 248)
  (unrealized (0 0) (1 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((3 1) (1 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 255)
  (parent 249)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 1 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 256)
  (parent 250)
  (unrealized (0 0) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 257)
  (parent 250)
  (unrealized (0 0) (1 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 258)
  (parent 251)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 259)
  (parent 252)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 260)
  (parent 253)
  (unrealized (0 0) (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 261)
  (parent 253)
  (unrealized (0 0) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 262)
  (parent 254)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 263)
  (parent 255)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 264)
  (parent 256)
  (unrealized (0 0) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 265)
  (parent 256)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 266)
  (parent 257)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 267)
  (parent 258)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 1 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 268)
  (parent 260)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((2 9) (1 9))
    ((3 1) (2 8)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 269)
  (parent 260)
  (unrealized (0 0) (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (1 9))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 270)
  (parent 261)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 271)
  (parent 262)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 1 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 272)
  (parent 264)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((3 9) (1 9)) ((4 1) (3 8)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (3 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 273)
  (parent 264)
  (unrealized (0 0) (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (1 9)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 274)
  (parent 265)
  (unrealized (0 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 275)
  (parent 266)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 1 clienta 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 276)
  (parent 268)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5)) ((2 7) (0 0))
    ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 277)
  (parent 268)
  (seen 288)
  (unrealized (0 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 278)
  (parent 268)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((2 9) (1 9))
    ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 279)
  (parent 269)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 280)
  (parent 270)
  (unrealized (0 0) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 1 clienta 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 281)
  (parent 272)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (1 5))
    ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 282)
  (parent 272)
  (seen 295)
  (unrealized (0 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 283)
  (parent 272)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 284)
  (parent 273)
  (unrealized (0 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 285)
  (parent 274)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 286)
  (parent 276)
  (realized)
  (shape)
  (satisfies
    (no (fact false) (any any) (cookie cookie) (response response)
      (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
      (ca ca) (cookiestor cookiestor) (z 1) (z-0 0)))
  (maps
    ((0 1)
      ((any any) (cookie cookie) (response response) (request request)
        (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
        (cookiestor cookiestor))))
  (origs (pt-0 (1 7)) (cookie (2 5)) (pt-2 (2 7)) (sr (2 1)) (cr (1 0))
    (pms (1 2))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 1 clienta 9) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 287)
  (parent 276)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 288)
  (parent 276)
  (seen 300)
  (unrealized (0 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 289)
  (parent 276)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5)) ((2 7) (0 0))
    ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 290)
  (parent 277)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 291)
  (parent 278)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 292)
  (parent 279)
  (unrealized (0 0) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 293)
  (parent 281)
  (seen 286)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 1 clienta 9) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 294)
  (parent 281)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 295)
  (parent 281)
  (seen 309)
  (unrealized (0 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 296)
  (parent 281)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (1 5))
    ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 297)
  (parent 282)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 298)
  (parent 283)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 299)
  (parent 284)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 300)
  (parent 287)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 301)
  (parent 287)
  (seen 286)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 302)
  (parent 287)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 303)
  (parent 287)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 304)
  (parent 288)
  (seen 286)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 305)
  (parent 288)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 306)
  (parent 289)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5)) ((2 7) (0 0))
    ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 307)
  (parent 290)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 308)
  (parent 291)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 309)
  (parent 294)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 310)
  (parent 294)
  (seen 301)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 311)
  (parent 294)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 312)
  (parent 294)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 313)
  (parent 295)
  (seen 304)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 314)
  (parent 295)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 315)
  (parent 296)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (1 5))
    ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 316)
  (parent 297)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 317)
  (parent 298)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-0 sr-0) "client_write")))))
  (label 318)
  (parent 300)
  (seen 304)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 319)
  (parent 300)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 320)
  (parent 300)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 321)
  (parent 302)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 322)
  (parent 303)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 323)
  (parent 305)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 324)
  (parent 306)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 325)
  (parent 307)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 5) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash pms-0 cr-1 sr-1) "client_write")))))
  (label 326)
  (parent 309)
  (seen 318)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "client_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 327)
  (parent 309)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener (hash (hash pms cr sr) "server_write")) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write"))
    (enc cookie request (hash (hash pms cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 328)
  (parent 309)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 329)
  (parent 311)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 330)
  (parent 312)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 331)
  (parent 314)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 332)
  (parent 315)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 333)
  (parent 316)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 334)
  (parent 319)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 335)
  (parent 320)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 336)
  (parent 321)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 337)
  (parent 322)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 338)
  (parent 323)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 339)
  (parent 327)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 340)
  (parent 328)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 341)
  (parent 329)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 342)
  (parent 330)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 343)
  (parent 331)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 344)
  (parent 334)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 345)
  (parent 335)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 346)
  (parent 339)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 347)
  (parent 340)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (cr sr random32)
        (pms random48))
      (implies
        (and (p "clienta" z 10) (p "clienta" "cookie" z cookie)
          (p "clienta" "u" z u) (p "clienta" "s" z s)
          (p "clienta" "ca" z ca) (p "clienta" "cr" z cr)
          (p "clienta" "sr" z sr) (p "clienta" "pms" z pms)
          (non (privk ca)) (non (privk s)) (uniq sr) (uniq-at cr z 0)
          (uniq-at pms z 2))
        (exists ((z0 strd))
          (and (p "servera" z0 10) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 348)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 349)
  (parent 348)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 350)
  (parent 349)
  (unrealized (0 3) (0 5) (0 9))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 351)
  (parent 350)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 352)
  (parent 350)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 353)
  (parent 350)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 354)
  (parent 351)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 355)
  (parent 351)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 356)
  (parent 352)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash pms cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 357)
  (parent 352)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 358)
  (parent 353)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 359)
  (parent 354)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 360)
  (parent 354)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 361)
  (parent 355)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))))
  (label 362)
  (parent 356)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 363)
  (parent 356)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 364)
  (parent 357)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 365)
  (parent 358)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 366)
  (parent 359)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 367)
  (parent 359)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 368)
  (parent 360)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 369)
  (parent 361)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 370)
  (parent 362)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 371)
  (parent 362)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 372)
  (parent 363)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 373)
  (parent 364)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 374)
  (parent 366)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (u u) (s s) (ca ca) (cr cr) (sr sr) (pms pms)
        (p p) (any any) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (sr (1 1)) (cr (0 0))
    (pms (0 2))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 375)
  (parent 366)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 376)
  (parent 367)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 377)
  (parent 368)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 378)
  (parent 370)
  (seen 374)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie request-0 (hash (hash pms cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 379)
  (parent 370)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 380)
  (parent 371)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 381)
  (parent 372)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8))
    ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 382)
  (parent 375)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 383)
  (parent 376)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 384)
  (parent 379)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 385)
  (parent 380)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 386)
  (parent 382)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 387)
  (parent 384)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (send (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (any mesg) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc "login" u p (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms cr sr) "server_write"))) (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (cr sr random32)
        (pms random48))
      (implies
        (and (p "clientr" z 7) (p "clientr" "cookie" z cookie)
          (p "clientr" "u" z u) (p "clientr" "s" z s)
          (p "clientr" "ca" z ca) (p "clientr" "cr" z cr)
          (p "clientr" "sr" z sr) (p "clientr" "pms" z pms)
          (non (privk ca)) (non (privk s)) (uniq sr) (uniq-at cr z 0)
          (uniq-at pms z 2))
        (exists ((z0 strd))
          (and (p "servera" z0 8) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 388)
  (unrealized (0 1) (0 3) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write")))))
  (label 389)
  (parent 388)
  (unrealized (0 1) (0 3) (0 4) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 390)
  (parent 389)
  (unrealized (0 3) (0 4) (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 391)
  (parent 390)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))))
  (label 392)
  (parent 390)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc
      (hash pms "server finished"
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (hash (hash pms cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 393)
  (parent 390)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 394)
  (parent 391)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 395)
  (parent 392)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 396)
  (parent 393)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 397)
  (parent 394)
  (unrealized (2 4) (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 398)
  (parent 394)
  (unrealized (2 4) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 399)
  (parent 394)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 400)
  (parent 395)
  (unrealized (3 4) (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 401)
  (parent 395)
  (unrealized (3 4) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "server_write"))
    (enc response (hash (hash pms cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write"))))
  (label 402)
  (parent 395)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 403)
  (parent 396)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 404)
  (parent 397)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 405)
  (parent 398)
  (unrealized (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 406)
  (parent 398)
  (unrealized (2 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 407)
  (parent 399)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 408)
  (parent 400)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write")))))
  (label 409)
  (parent 401)
  (unrealized (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) "client_write"))
    (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write"))))
  (label 410)
  (parent 401)
  (unrealized (3 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "server_write"))
    (hash (hash pms cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write"))))
  (label 411)
  (parent 402)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 412)
  (parent 404)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 413)
  (parent 405)
  (realized)
  (shape)
  (satisfies
    (no (p "servera" "u" z0 u) (z 0) (cookie cookie) (u u) (s s)
      (ca ca-0) (cr cr) (sr sr) (pms pms)))
  (maps
    ((0)
      ((cookie cookie) (u u) (s s) (ca ca-0) (cr cr) (sr sr) (pms pms)
        (cookiestor cookiestor) (request request) (response response))))
  (origs (cookie (3 5)) (pt-1 (3 7)) (pt (1 7)) (sr (2 1)) (cr (0 0))
    (pms (0 2))))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 414)
  (parent 406)
  (unrealized (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 415)
  (parent 407)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 416)
  (parent 408)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 417)
  (parent 409)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-2)
      (send (cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-2 sr-2
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-2 sr-2) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-2 sr-2
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-2 sr-2
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-2 sr-2) "client_write"))))
          (hash (hash pms-1 cr-2 sr-2) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-2 sr-2) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-2 sr-2) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 418)
  (parent 409)
  (seen 413)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) "client_write"))
    (hash (hash pms cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write"))))
  (label 419)
  (parent 410)
  (unrealized (3 5) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) "server_write"))
  (deflistener (cat (hash pms cr sr) "server_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write"))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash pms cr sr) "server_write"))
      (send (hash (hash pms cr sr) "server_write")))
    ((recv (cat (hash pms cr sr) "server_write"))
      (send (cat (hash pms cr sr) "server_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 420)
  (parent 411)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 421)
  (parent 412)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 422)
  (parent 414)
  (unrealized (2 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0 (hash (hash pms cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash pms cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 423)
  (parent 416)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 2))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 1)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 424)
  (parent 417)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) "client_write"))
  (deflistener (cat (hash pms cr sr) "client_write"))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) "client_write"))))
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-1 sr-1) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-1 sr-1) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0 (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv (hash (hash pms cr sr) "client_write"))
      (send (hash (hash pms cr sr) "client_write")))
    ((recv (cat (hash pms cr sr) "client_write"))
      (send (cat (hash pms cr sr) "client_write")))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 425)
  (parent 419)
  (unrealized (3 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 3))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (2 2)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 426)
  (parent 424)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 3)))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 427)
  (parent 426)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (u u-0) (s s) (ca ca-1) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (privk s) (privk ca-0) (privk ca-1))
  (uniq-orig cookie cr sr pms)
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated ca-1)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (recv
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) "client_write")))
      (recv (enc response (hash (hash pms cr sr) "server_write"))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 "client finished"
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) "client_write"))))
      (recv
        (enc
          (hash pms-0 "server finished"
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 "client finished"
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) "client_write"))))
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p (hash (hash pms-0 cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash pms-0 cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms "client finished"
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) "client_write"))))
      (send
        (enc
          (hash pms "server finished"
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms "client finished"
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) "client_write"))))
          (hash (hash pms cr sr) "server_write")))
      (recv (enc cookie request (hash (hash pms cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) "server_write"))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 "client finished"
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) "client_write"))))
      (send
        (enc
          (hash pms-1 "server finished"
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 "client finished"
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) "client_write"))))
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash pms-1 cr-1 sr-1) "server_write")))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 428)
  (parent 427)
  (seen 413)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(comment "Nothing left to do")
