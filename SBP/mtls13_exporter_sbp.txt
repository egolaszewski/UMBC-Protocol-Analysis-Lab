(herald
  "Session Binding Protocol with mTLS 1.3and TLS Exporter Binding/client's perspective analysis (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack)."
  (bound 12) (limit 16000))

(comment "CPSA 4.4.5")
(comment "All input read from mtls13_exporter_sbp.scm")
(comment "Step count limited to 16000")

(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule partial-server-merge
    (forall ((z0 z1 strd) (spk akey) (s ca name))
      (implies
        (and (p "serverr" z0 (idx 2)) (p "serverr" z1 (idx 2))
          (p "serverr" "spk" z0 spk) (p "serverr" "spk" z1 spk)
          (p "serverr" "s" z0 s) (p "serverr" "s" z1 s)
          (p "serverr" "ca" z0 ca) (p "serverr" "ca" z1 ca))
        (= z0 z1))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "u" z u)
          (p "servera" "s" z s)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "u" z u)
          (p "serverr" "s" z s)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (u s name) (cookie mesg))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (s u name) (cookie data))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 0)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (ugens (x (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (ugens (x (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (strand-map 0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 2)
  (parent 1)
  (seen 3)
  (seen-ops
    (3
      (operation encryption-test (added-strand serverr 2)
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
      (strand-map 0 1)))
  (unrealized (0 1))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 3)
  (parent 2)
  (unrealized (0 4) (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 2 servera 5)
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul x y-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 4))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 4)
  (parent 3)
  (unrealized (0 8) (1 2) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 4))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 5)
  (parent 3)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clientr 3)
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
            (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0
          (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
              (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 6)
  (parent 4)
  (unrealized (0 8) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 4) (0 4))
    ((2 1) (1 2)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
            (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0
          (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
              (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 7)
  (parent 4)
  (unrealized (0 8) (1 2) (1 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 4))
    ((3 1) (2 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 8)
  (parent 5)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clienta 4)
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))) (1 3))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 9)
  (parent 6)
  (unrealized (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (2 0))
    ((1 4) (0 4)) ((2 1) (1 3)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 3))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 10)
  (parent 6)
  (unrealized (0 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 11)
  (parent 7)
  (unrealized (1 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 12)
  (parent 8)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x)) "derived"))) (0 8))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 13)
  (parent 9)
  (unrealized (1 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((2 1) (0 8)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 8))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 14)
  (parent 9)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (3 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 15)
  (parent 10)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 16)
  (parent 11)
  (unrealized (1 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 17)
  (parent 11)
  (unrealized (1 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 18)
  (parent 12)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 19)
  (parent 12)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 7) (1 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul x-0 y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))) (1 7))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 20)
  (parent 13)
  (realized)
  (shape)
  (maps
    ((0)
      ((c c) (u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (spk spk)
        (cpk cpk) (x x) (y y)
        (cookie
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))) (any any)
        (cookiestor cookiestor) (request request) (response response))))
  (origs (pt-0 (0 6)) (cookie (1 6)) (pt-2 (1 6)) (cr (0 0)) (sr (1 1)))
  (ugens (x (0 0)) (y (1 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 7))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 21)
  (parent 13)
  (unrealized (1 7) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 22)
  (parent 14)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (4 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 23)
  (parent 15)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 24)
  (parent 21)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 25)
  (parent 22)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 26)
  (parent 23)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (cpk spk akey) (c u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u-0 s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 27)
  (parent 23)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 28)
  (parent 24)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 29)
  (parent 25)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (cpk spk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk cpk) (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 30)
  (parent 25)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 31)
  (parent 28)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 32)
  (parent 28)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule partial-server-merge
    (forall ((z0 z1 strd) (spk akey) (s ca name))
      (implies
        (and (p "serverr" z0 (idx 2)) (p "serverr" z1 (idx 2))
          (p "serverr" "spk" z0 spk) (p "serverr" "spk" z1 spk)
          (p "serverr" "s" z0 s) (p "serverr" "s" z1 s)
          (p "serverr" "ca" z0 ca) (p "serverr" "ca" z1 ca))
        (= z0 z1))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "u" z u)
          (p "servera" "s" z s)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "u" z u)
          (p "serverr" "s" z s)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (u s name) (cookie mesg))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (s u name) (cookie data))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (y rndx) (x expt))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 33)
  (unrealized (0 2))
  (origs (pt-0 (0 6)) (sr (0 1)) (cookie (0 6)))
  (ugens (y (0 1)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (y rndx) (x expt))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 34)
  (parent 33)
  (unrealized (0 2))
  (origs (pt-0 (0 6)) (sr (0 1)) (cookie (0 6)))
  (ugens (y (0 1)))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 akey)
    (c s ca u s-0 name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 rndx) (y-0 expt))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x-0) (y y-0))
  (precedes ((1 2) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 3)
    (enc (hash c cpk) (privk ca)) (0 2))
  (strand-map 0)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))))
  (label 35)
  (parent 34)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (s ca u name)
    (pt pt-0 pval) (authstor locn) (x expt) (y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk spk) (c s)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 0 serverr 2)
    (enc (hash c cpk) (privk ca)) (0 2))
  (strand-map 0)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) s
              spk (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                s spk (enc (hash s spk) (privk ca))) (invk spk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 36)
  (parent 34)
  (unrealized (0 2))
  (dead)
  (origs (pt-0 (0 6)) (sr (0 1)) (cookie (0 6)))
  (ugens (y (0 1)))
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 rndx) (x-0 expt))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash c cpk) (privk ca)) (0 2))
  (strand-map 0)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) c cpk
                  (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 37)
  (parent 34)
  (unrealized (0 2))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (x rndx) (y x-0 expt)
    (y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 serverr 2)
    (enc (hash s-0 spk-0) (privk ca)) (1 1))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))))
  (label 38)
  (parent 35)
  (seen 41)
  (seen-ops
    (41
      (operation encryption-test (added-strand serverr 2)
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
      (strand-map 0 1)))
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt) (y-1 rndx)
    (x-1 expt))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-1) (x x-1))
  (precedes ((1 2) (0 2)) ((2 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-1)
  (absent (y x) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s-0 spk-0) (privk ca)) (1 1))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
              sr-1))))))
  (label 39)
  (parent 35)
  (seen 41)
  (seen-ops
    (41
      (operation encryption-test (displaced 3 1 clientr 3)
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
            cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (0 2))
      (strand-map 0 1 0)))
  (unrealized (0 2))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((1 1) (0 2)) ((2 0) (0 0)) ((2 2) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 3)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk
        (enc (hash c cpk) (privk ca))) (invk cpk)) (0 2))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))))
  (label 40)
  (parent 37)
  (unrealized (0 3) (0 7))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (precedes ((0 1) (1 1)) ((1 0) (0 0)) ((1 2) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))))
  (label 41)
  (parent 38)
  (unrealized (0 3) (0 7))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (precedes ((0 1) (3 1)) ((1 2) (0 2)) ((2 1) (1 1)) ((3 0) (0 0))
    ((3 2) (0 2)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 3)
    (enc
      (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
          (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk
        (enc (hash c cpk) (privk ca))) (invk cpk)) (0 2))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))))
  (label 42)
  (parent 39)
  (unrealized (0 3) (0 7))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((1 1) (0 2)) ((2 0) (0 0)) ((2 2) (0 2))
    ((2 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 3 clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-0)) "derived"))) (0 3))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 43)
  (parent 40)
  (unrealized (0 7))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 44)
  (parent 40)
  (unrealized (0 7) (3 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 1) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 45)
  (parent 40)
  (unrealized (0 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 1) (1 1)) ((1 0) (0 0)) ((1 2) (0 2)) ((1 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))) (0 3))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 46)
  (parent 41)
  (unrealized (0 7))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn)
    (x y x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-0) (y (mul x y (rec x-0))))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul x y (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x y (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 47)
  (parent 41)
  (unrealized (0 7) (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 1) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 48)
  (parent 41)
  (unrealized (0 7) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (precedes ((0 1) (3 1)) ((1 2) (0 2)) ((2 1) (1 1)) ((3 0) (0 0))
    ((3 2) (0 2)) ((3 3) (0 3)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 4 clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-2 y-1)) "derived"))) (0 3))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 49)
  (parent 42)
  (unrealized (0 7))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (s u c s-0 ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 2) (0 2)) ((3 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 4 clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-2 y-1)) "derived"))) (0 3))
  (strand-map 0 3 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 50)
  (parent 42)
  (unrealized (0 7) (3 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 spk-1 cpk-0 akey) (c s ca u s-0 c-0 s-1 ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt) (x-1 y-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u) (s s-1) (ca ca-0) (x x-2) (y (mul x-1 y-1 (rec x-2))))
  (precedes ((0 1) (3 1)) ((0 1) (4 1)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 3) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 4)
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived"))) (0 3))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
  (label 51)
  (parent 42)
  (unrealized (0 7) (4 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (4 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 1) (0 3)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived")))
    (enc "login" u p
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived"))) (0 3))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (label 52)
  (parent 42)
  (unrealized (0 7) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (0 7))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 53)
  (parent 43)
  (unrealized (3 1) (3 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((1 1) (0 2)) ((2 0) (0 0)) ((2 2) (0 2))
    ((2 3) (0 3)) ((2 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 3 clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s-0)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-1)) "derived"))) (0 7))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 54)
  (parent 43)
  (unrealized (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 4) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_servera-at-5
    trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 5)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (0 7))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 55)
  (parent 43)
  (unrealized (3 1) (3 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 1) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (0 7))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 56)
  (parent 43)
  (unrealized (0 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
  (label 57)
  (parent 44)
  (unrealized (0 7) (3 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 58)
  (parent 45)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y (mul y x (rec x-0))))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 7))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 59)
  (parent 46)
  (unrealized (2 1) (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (precedes ((0 1) (1 1)) ((1 0) (0 0)) ((1 2) (0 2)) ((1 3) (0 3))
    ((1 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s-0)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x-0)) "derived"))) (0 7))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 60)
  (parent 46)
  (unrealized (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y (mul y x (rec x-0))))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 4) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_servera-at-5
    trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 5)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 7))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 61)
  (parent 46)
  (unrealized (2 1) (2 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 1) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 7))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 62)
  (parent 46)
  (unrealized (0 7) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn)
    (x y x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-0) (y (mul x y (rec x-0))))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 3) (0 3)) ((3 1) (2 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul x y (rec x-0))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)) (2 1))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul x y (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x y (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
  (label 63)
  (parent 47)
  (unrealized (0 7) (2 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 64)
  (parent 48)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u-0) (s s-1) (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (precedes ((0 1) (3 1)) ((0 1) (4 1)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 7) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (added-strand clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (0 7))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 65)
  (parent 49)
  (unrealized (4 1) (4 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (precedes ((0 1) (3 1)) ((1 2) (0 2)) ((2 1) (1 1)) ((3 0) (0 0))
    ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 4 clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-2)) "derived")
          "EXPORTER-Channel-Binding" cr sr u-0 s-1)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-2)) "derived"))) (0 7))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 66)
  (parent 49)
  (unrealized (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (u s c u-0 s-0 ca name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk)
    (c c) (u u-0) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 4 clienta 8)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-2)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-2)) "derived"))) (0 7))
  (strand-map 0 3 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 67)
  (parent 49)
  (unrealized (3 1) (3 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (u s c u-0 s-0 ca name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s-0) (ca ca)
    (cookiestor cookiestor) (x x-1) (y (mul y-0 x-0 (rec x-1))))
  (precedes ((0 1) (2 1)) ((0 1) (3 1)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 4) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_servera-at-5
    trRl_servera-at-6)
  (operation encryption-test (displaced 1 4 clientr 5)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-2)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-2)) "derived"))) (0 7))
  (strand-map 0 3 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 68)
  (parent 49)
  (unrealized (3 1) (3 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (request request)
    (cr cr) (sr sr) (spk spk-1) (cpk cpk-0) (c c-0) (u u-0) (s s-1)
    (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (precedes ((0 1) (3 1)) ((0 1) (4 1)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 4) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u-0 s-1
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))))
  (facts (neq u s-0))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_servera-at-5
    trRl_servera-at-6)
  (operation encryption-test (added-strand clientr 5)
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (0 7))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 69)
  (parent 49)
  (unrealized (4 1) (4 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (4 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0)) request
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (0 7))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 70)
  (parent 49)
  (unrealized (0 7) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (s u c s-0 ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
  (label 71)
  (parent 50)
  (unrealized (0 7) (3 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 spk-1 cpk-0 akey) (c s ca u s-0 c-0 s-1 ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt) (x-1 y-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u) (s s-1) (ca ca-0) (x x-2) (y (mul x-1 y-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 3) (0 3)) ((5 1) (4 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
    (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-2))
          (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
          (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-2))
        (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
        (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
            (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
      (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)) (4 1))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
  (label 72)
  (parent 51)
  (unrealized (0 7) (4 1) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 1) (0 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (label 73)
  (parent 52)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 7) (0 7)) ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 74)
  (parent 53)
  (unrealized (3 1) (3 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 4) (2 4)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 0 servera 5)
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-0)) "derived"))) (2 4))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 75)
  (parent 54)
  (seen 82)
  (seen-ops
    (82 (operation generalization deleted (1 0)) (strand-map 0 2)))
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 4))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 76)
  (parent 54)
  (unrealized (2 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 4) (0 7)) ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 77)
  (parent 55)
  (unrealized (3 1) (3 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 1) (0 7)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 78)
  (parent 56)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
  (label 79)
  (parent 57)
  (unrealized (3 1) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 80)
  (parent 58)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul y x (rec x-0))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)) (2 1))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 81)
  (parent 59)
  (unrealized (2 1) (2 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x y)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 servera 5)
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x)) "derived"))) (1 4))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 82)
  (parent 60)
  (realized)
  (shape)
  (maps
    ((0)
      ((c c) (s s) (ca ca) (cr cr) (sr sr) (spk spk) (cpk cpk)
        (cookie cookie) (u u) (y y) (x x) (p p) (any any)
        (authstor authstor) (request request) (response response))))
  (origs (pt-2 (1 6)) (pt-0 (0 6)) (sr (0 1)) (cookie (0 6)))
  (ugens (y (0 1)) (x (1 0))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)) ((2 1) (1 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (1 4))
  (strand-map 0 1)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 83)
  (parent 60)
  (unrealized (1 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 4) (0 7)) ((3 1) (2 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul y x (rec x-0))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)) (2 1))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 84)
  (parent 61)
  (unrealized (2 1) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 1) (0 7)) ((3 1) (2 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 85)
  (parent 62)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn)
    (x y x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-0) (y (mul x y (rec x-0))))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 3) (0 3)) ((3 1) (2 1)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul x y (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x y (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))))
  (label 86)
  (parent 63)
  (unrealized (2 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 1) (0 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 87)
  (parent 64)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u-0) (s s-1) (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 7) (0 7))
    ((5 1) (4 1)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
    (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-2))
          (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
          (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-2))
        (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
        (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
            (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
      (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)) (4 1))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
  (label 88)
  (parent 65)
  (unrealized (4 1) (4 4) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (precedes ((0 1) (3 1)) ((0 4) (3 4)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 4 0 servera 5)
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y-2 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-2 x-1)) "derived"))) (3 4))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
  (label 89)
  (parent 66)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (4 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7))
    ((4 1) (3 4)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc "login-successful"
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (3 4))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 90)
  (parent 66)
  (unrealized (3 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (u s c u-0 s-0 ca name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk)
    (c c) (u u-0) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 7) (0 7))
    ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 91)
  (parent 67)
  (unrealized (3 1) (3 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (u s c u-0 s-0 ca name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s-0) (ca ca)
    (cookiestor cookiestor) (x x-1) (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 4) (0 7))
    ((4 1) (3 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
          (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-1))
        (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
        (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
            (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
      (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)) (3 1))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 92)
  (parent 68)
  (unrealized (3 1) (3 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (request request)
    (cr cr) (sr sr) (spk spk-1) (cpk cpk-0) (c c-0) (u u-0) (s s-1)
    (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 4) (0 7))
    ((5 1) (4 1)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u-0 s-1
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
    (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-2))
          (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
          (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-2))
        (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
        (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
            (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
      (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)) (4 1))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
  (label 93)
  (parent 69)
  (unrealized (4 1) (4 3) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (0 7))
    ((5 1) (4 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 94)
  (parent 70)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (s u c s-0 ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
  (label 95)
  (parent 71)
  (unrealized (3 1) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 spk-1 cpk-0 akey) (c s ca u s-0 c-0 s-1 ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt) (x-1 y-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u) (s s-1) (ca ca-0) (x x-2) (y (mul x-1 y-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 3) (0 3)) ((5 1) (4 1))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
  (label 96)
  (parent 72)
  (unrealized (4 1) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "derived"))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 1) (0 3)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-1 y-1)) "derived"))
    (hash (exp (gen) (mul x-1 y-1)) "derived") (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "derived"))
      (send (cat (exp (gen) (mul x-1 y-1)) "derived"))))
  (label 97)
  (parent 73)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 7) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 98)
  (parent 74)
  (unrealized (3 1) (3 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 99)
  (parent 76)
  (unrealized (2 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 4) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 100)
  (parent 77)
  (unrealized (3 1) (3 3) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 1) (0 7)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 101)
  (parent 78)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 102)
  (parent 79)
  (unrealized (3 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 103)
  (parent 79)
  (unrealized (3 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 104)
  (parent 80)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c s ca u name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 105)
  (parent 80)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 1)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 106)
  (parent 81)
  (unrealized (2 1) (2 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 107)
  (parent 83)
  (unrealized (1 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 4) (0 7)) ((3 1) (2 1)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr) (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 108)
  (parent 84)
  (unrealized (2 1) (2 3) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 1) (0 7)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 109)
  (parent 85)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn)
    (x y x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-0) (y (mul x y (rec x-0))))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 3) (0 3)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul x y (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x y (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 110)
  (parent 86)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (c s ca u c-0 s-0 ca-0 name) (pt pt-0 pval) (authstor locn)
    (x y x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u) (s s-0) (ca ca-0) (x x-0) (y (mul x y (rec x-0))))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 3) (0 3)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul x y (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul x y (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x y (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul x y (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul x y (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul x y (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul x y (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x y (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 111)
  (parent 86)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 1) (0 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 112)
  (parent 87)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c s ca u name)
    (pt pt-0 pval) (authstor locn) (x y rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((2 1) (0 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x y)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 113)
  (parent 87)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u-0) (s s-1) (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 7) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
  (label 114)
  (parent 88)
  (unrealized (4 1) (4 4) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 4) (2 4)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation generalization deleted (1 0))
  (strand-map 0 2 3)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 115)
  (parent 89)
  (seen 82)
  (seen-ops
    (82 (operation generalization deleted (1 0)) (strand-map 0 2)))
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 1) (3 1)) ((0 1) (5 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 116)
  (parent 90)
  (unrealized (3 4) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (u s c u-0 s-0 ca name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk)
    (c c) (u u-0) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 7) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 117)
  (parent 91)
  (unrealized (3 1) (3 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (u s c u-0 s-0 ca name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s-0) (ca ca)
    (cookiestor cookiestor) (x x-1) (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 4) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
  (label 118)
  (parent 92)
  (unrealized (3 1) (3 3) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (request request)
    (cr cr) (sr sr) (spk spk-1) (cpk cpk-0) (c c-0) (u u-0) (s s-1)
    (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 4) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u-0 s-1
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
  (label 119)
  (parent 93)
  (unrealized (4 1) (4 3) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (0 7))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-1 x-1)) "derived"))
    (hash (exp (gen) (mul y-1 x-1)) "derived") (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived"))))
  (label 120)
  (parent 94)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (s u c s-0 ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 121)
  (parent 95)
  (unrealized (3 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (s u c s-0 ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (x-0 y-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-0) (y y-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y (mul x-0 y-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul x-0 y-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul x-0 y-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-0 y-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 122)
  (parent 95)
  (unrealized (3 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 spk-1 cpk-0 akey) (c s ca u s-0 c-0 s-1 ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt) (x-1 y-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u) (s s-1) (ca ca-0) (x x-2) (y (mul x-1 y-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 3) (0 3)) ((5 1) (4 1))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 123)
  (parent 96)
  (unrealized (4 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 spk-1 cpk-0 akey) (c s ca u s-0 c-0 s-1 ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt) (x-1 y-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u) (s s-1) (ca ca-0) (x x-2) (y (mul x-1 y-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 3) (0 3)) ((5 1) (4 1))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul x-1 y-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul x-1 y-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul x-1 y-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 124)
  (parent 96)
  (unrealized (4 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 1) (0 3)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "derived"))
      (send (cat (exp (gen) (mul x-1 y-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 125)
  (parent 97)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk cpk spk-0 akey) (c s ca u s-0 name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (x-1 y-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c)
    (s s-0) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk-0) (s s-0) (ca ca)
    (y y-0) (x x-0))
  (defstrand clientr 3 (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (s s)
    (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-1 y-1)) "derived")))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((4 1) (0 3)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 x-1 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-1 y-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "derived"))
      (send (cat (exp (gen) (mul x-1 y-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 126)
  (parent 97)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 7) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 127)
  (parent 98)
  (unrealized (3 1) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 7) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 128)
  (parent 98)
  (unrealized (3 1) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 129)
  (parent 99)
  (unrealized (2 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 4) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 130)
  (parent 100)
  (unrealized (3 1) (3 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 4) (0 7)) ((4 1) (3 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 131)
  (parent 100)
  (unrealized (3 1) (3 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 1) (0 7)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 132)
  (parent 101)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (u c s ca name) (pt pt-0 pval) (authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 1) (0 7)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 133)
  (parent 101)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 134)
  (parent 106)
  (unrealized (2 1) (2 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr random32)
    (spk cpk spk-0 cpk-0 akey) (u c s ca c-0 u-0 s-0 ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk-0)
    (c c-0) (u u-0) (s s-0) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 135)
  (parent 106)
  (unrealized (2 1) (2 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 136)
  (parent 107)
  (unrealized (1 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 4) (0 7)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 137)
  (parent 108)
  (unrealized (2 1) (2 3) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk spk-0 cpk-0 akey)
    (u c s ca c-0 u-0 s-0 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y x x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk-0) (c c-0) (u u-0) (s s-0)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 4) (0 7)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y x (rec x-0))))
                (cat sr (exp (gen) x-0))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                    (cat sr (exp (gen) x-0)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y x (rec x-0))))
              (cat sr (exp (gen) x-0))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) (mul y x (rec x-0)))) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) (mul y x (rec x-0))))
                  (cat sr (exp (gen) x-0))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y x (rec x-0))))
                      (cat sr (exp (gen) x-0)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca-0)))
                    (invk spk-0))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 138)
  (parent 108)
  (unrealized (2 1) (2 3) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 1) (0 7)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 139)
  (parent 109)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (u c s ca name)
    (pt pt-0 pval) (authstor locn) (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((2 1) (0 7)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 140)
  (parent 109)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u-0) (s s-1) (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 7) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 141)
  (parent 114)
  (unrealized (4 1) (4 4) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-1) (cpk cpk-0)
    (c c-0) (u u-0) (s s-1) (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 7) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 142)
  (parent 114)
  (unrealized (4 1) (4 4) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (precedes ((0 1) (3 1)) ((0 1) (6 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-1 x-1)) "derived"))
    (hash (exp (gen) (mul y-1 x-1)) "derived") (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived"))))
  (label 143)
  (parent 116)
  (unrealized (3 4) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (u s c u-0 s-0 ca name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk)
    (c c) (u u-0) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 7) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 144)
  (parent 117)
  (unrealized (3 1) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 cpk akey) (u s c u-0 s-0 ca name)
    (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn) (y rndx)
    (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p-0) (cr cr) (sr sr) (spk spk-0) (cpk cpk)
    (c c) (u u-0) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1)
    (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 7) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 145)
  (parent 117)
  (unrealized (3 1) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (u s c u-0 s-0 ca name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s-0) (ca ca)
    (cookiestor cookiestor) (x x-1) (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 4) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 146)
  (parent 118)
  (unrealized (3 1) (3 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 cpk akey)
    (u s c u-0 s-0 ca name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s-0) (ca ca)
    (y y) (x x))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (x x-0) (y y-0))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (request request)
    (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s-0) (ca ca)
    (cookiestor cookiestor) (x x-1) (y (mul y-0 x-0 (rec x-1))))
  (deflistener (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (3 1)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((3 2) (0 2)) ((3 4) (0 7))
    ((4 1) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u-0 s-0
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0 spk-0
                (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
              (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1)) s-0 spk-0
                  (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul y-0 x-0 (rec x-1))))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) (mul y-0 x-0 (rec x-1)))) s-0
                    spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-0 x-0 (rec x-1))))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 147)
  (parent 118)
  (unrealized (3 1) (3 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (request request)
    (cr cr) (sr sr) (spk spk-1) (cpk cpk-0) (c c-0) (u u-0) (s s-1)
    (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 4) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u-0 s-1
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 148)
  (parent 119)
  (unrealized (4 1) (4 3) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk spk-1 cpk-0 akey)
    (u s c s-0 ca c-0 u-0 s-1 ca-0 name) (pt pt-0 pt-1 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 x-2 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (defstrand clientr 5
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (request request)
    (cr cr) (sr sr) (spk spk-1) (cpk cpk-0) (c c-0) (u u-0) (s s-1)
    (ca ca-0) (cookiestor cookiestor) (x x-2)
    (y (mul y-1 x-1 (rec x-2))))
  (deflistener (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 4) (0 7))
    ((5 1) (4 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1 x-2)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u-0 s-1
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr (exp (gen) x-2)))
      (recv
        (cat (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
          (enc (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-2))
              (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-2))
                  (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat sr (exp (gen) x-2))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                    (cat sr (exp (gen) x-2)) s-1 spk-1
                    (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-2))
            (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
            (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1 spk-1
                (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
              (cat sr (exp (gen) x-2))
              (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2)) s-1 spk-1
                  (enc (hash s-1 spk-1) (privk ca-0))) (invk spk-1)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-2))
                (cat sr (exp (gen) (mul y-1 x-1 (rec x-2))))
                (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                (enc
                  (hash (cat cr (exp (gen) x-2))
                    (cat sr (exp (gen) (mul y-1 x-1 (rec x-2)))) s-1
                    spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (invk spk-1))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                  (cat sr (exp (gen) x-2))
                  (cat s-1 spk-1 (enc (hash s-1 spk-1) (privk ca-0)))
                  (enc
                    (hash (cat cr (exp (gen) (mul y-1 x-1 (rec x-2))))
                      (cat sr (exp (gen) x-2)) s-1 spk-1
                      (enc (hash s-1 spk-1) (privk ca-0)))
                    (invk spk-1))) c-0 cpk-0
                (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt-1 "client store" u-0 s-1
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 149)
  (parent 119)
  (unrealized (4 1) (4 3) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (0 7))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 150)
  (parent 120)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (u s c s-0 ca name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 4 (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (x x-1) (y y-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((4 1) (0 7))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 151)
  (parent 120)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 152)
  (parent 129)
  (unrealized (2 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk cpk) (s c) (ca ca) (y y)
    (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((1 1) (0 2)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 3) (0 3)) ((2 7) (0 7)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) c
                cpk (enc (hash c cpk) (privk ca))) (invk cpk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat c cpk (enc (hash c cpk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 153)
  (parent 129)
  (unrealized (2 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 154)
  (parent 136)
  (unrealized (1 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pt-1 pt-2 pval) (authstor cookiestor locn)
    (y x rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y x)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 7) (0 7)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 155)
  (parent 136)
  (unrealized (1 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 156)
  (parent 143)
  (unrealized (3 4) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (spk spk-0 cpk akey) (s c u s-0 ca name) (pt pt-0 pt-1 pt-2 pval)
    (authstor cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt)
    (y-1 x-1 rndx))
  (defstrand servera 9 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (authstor authstor) (y y-1) (x x-1))
  (defstrand clientr 3 (cr cr-0) (sr sr-0) (spk spk) (cpk cpk) (c c)
    (s s) (ca ca) (x x) (y y))
  (defstrand serverr 2 (cr cr-1) (sr sr-1) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (hash cookie
        (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
          "EXPORTER-Channel-Binding" cr sr u s-0))) (any any-0)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (cpk cpk) (c c)
    (u u) (s s-0) (ca ca) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 1) (3 1)) ((0 1) (7 0)) ((1 2) (0 2)) ((2 1) (1 1))
    ((3 0) (0 0)) ((3 2) (0 2)) ((3 3) (0 3)) ((3 7) (0 7))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (invk cpk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x y-0 y-1 x-1)
  (absent (y-0 x-0) (y-1 x-1))
  (facts (neq u s-0))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (strand-map 0 1 2 3 4 5 6)
  (traces
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s-0 u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
                (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y))
                    (cat sr-0 (exp (gen) x)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y)) (cat sr-0 (exp (gen) x))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x))
                    (cat sr-0 (exp (gen) y)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y))
                  (cat sr-0 (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y))
                      (cat sr-0 (exp (gen) x)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-1
              sr-1)))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-1))
                    (cat sr (exp (gen) x-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
              (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-1)) (cat sr (exp (gen) x-1))
                  s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-1))
                    (cat sr (exp (gen) y-1)) s-0 spk-0
                    (enc (hash s-0 spk-0) (privk ca))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr
                      sr)) (cat cr (exp (gen) y-1))
                  (cat sr (exp (gen) x-1))
                  (cat s-0 spk-0 (enc (hash s-0 spk-0) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-1))
                      (cat sr (exp (gen) x-1)) s-0 spk-0
                      (enc (hash s-0 spk-0) (privk ca))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load cookiestor (cat pt-1 any-0))
      (stor cookiestor
        (cat pt-2 "client store" u s-0
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0))))
      (send
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y-1 x-1)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s-0)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 157)
  (parent 143)
  (unrealized (3 4) (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule partial-server-merge
    (forall ((z0 z1 strd) (spk akey) (s ca name))
      (implies
        (and (p "serverr" z0 (idx 2)) (p "serverr" z1 (idx 2))
          (p "serverr" "spk" z0 spk) (p "serverr" "spk" z1 spk)
          (p "serverr" "s" z0 s) (p "serverr" "s" z1 s)
          (p "serverr" "ca" z0 ca) (p "serverr" "ca" z1 ca))
        (= z0 z1))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "u" z u)
          (p "servera" "s" z s)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "u" z u)
          (p "serverr" "s" z s)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (u s name) (cookie mesg))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (s u name) (cookie data))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((cookie data) (p password) (cr sr random32) (spk cpk akey)
        (c u s ca name) (x rndx) (y expt) (z z-0 strd))
      (implies
        (and (p "clienta" z 9) (p "" z-0 2)
          (p "clienta" "cookie" z cookie) (p "clienta" "p" z p)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "spk" z spk) (p "clienta" "cpk" z cpk)
          (p "clienta" "c" z c) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "y" z y) (p "" "x" z-0 cookie)
          (p "clienta" "x" z x) (non (invk spk)) (non (invk cpk))
          (non (privk ca)) (pnon p) (uniq sr) (ugen x) (uniq-at cr z 0))
        (false))))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 158)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (ugens (x (1 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 159)
  (parent 158)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (ugens (x (1 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (strand-map 0 1)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 160)
  (parent 159)
  (seen 161)
  (seen-ops
    (161
      (operation encryption-test (added-strand serverr 2)
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
      (strand-map 0 1 2)))
  (unrealized (1 1))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (strand-map 0 1 2)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 161)
  (parent 160)
  (unrealized (1 4) (1 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (3 0)) ((3 1) (1 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 4))
  (strand-map 0 1 2)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 162)
  (parent 161)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (4 0)) ((3 1) (1 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (3 0))
  (strand-map 0 1 2 3)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 163)
  (parent 162)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (5 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (4 0))
  (strand-map 0 1 2 3 4)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 164)
  (parent 163)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 165)
  (parent 164)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (strand-map 0 1 2 3 4 5)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 166)
  (parent 164)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule partial-server-merge
    (forall ((z0 z1 strd) (spk akey) (s ca name))
      (implies
        (and (p "serverr" z0 (idx 2)) (p "serverr" z1 (idx 2))
          (p "serverr" "spk" z0 spk) (p "serverr" "spk" z1 spk)
          (p "serverr" "s" z0 s) (p "serverr" "s" z1 s)
          (p "serverr" "ca" z0 ca) (p "serverr" "ca" z1 ca))
        (= z0 z1))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "u" z u)
          (p "servera" "s" z s)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "u" z u)
          (p "serverr" "s" z s)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (u s name) (cookie mesg))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (s u name) (cookie data))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (c u s ca name) (spk cpk akey)
        (cr sr random32) (ppk skey) (x rndx) (y expt))
      (implies
        (and (p "clienta" z 9)
          (p "clienta" "cookie" z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) "derived"))))
          (p "clienta" "c" z c) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "spk" z spk)
          (p "clienta" "cpk" z cpk) (p "clienta" "ca" z ca)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "x" z x) (p "clienta" "y" z y) (non (privk ca))
          (non (invk cpk)) (non (invk spk)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p "servera" z0 9) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 167)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (ugens (x (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 168)
  (parent 167)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (ugens (x (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (strand-map 0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 169)
  (parent 168)
  (seen 170)
  (seen-ops
    (170
      (operation encryption-test (added-strand serverr 2)
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
      (strand-map 0 1)))
  (unrealized (0 1) (0 4))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 170)
  (parent 169)
  (unrealized (0 4) (0 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 4))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 171)
  (parent 170)
  (unrealized (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 4))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 172)
  (parent 171)
  (unrealized (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (strand-map 0 1 2 3)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 173)
  (parent 172)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 174)
  (parent 173)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (strand-map 0 1 2 3 4)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 175)
  (parent 173)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (hash cookie
            (hash (hash (exp (gen) (mul y x)) "derived")
              "EXPORTER-Channel-Binding" cr sr u s)) request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clienta" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clientr" "s" z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p "clientr" "c" z c) (p "clienta" "s" z-0 c))
        (false))))
  (defrule partial-server-merge
    (forall ((z0 z1 strd) (spk akey) (s ca name))
      (implies
        (and (p "serverr" z0 (idx 2)) (p "serverr" z1 (idx 2))
          (p "serverr" "spk" z0 spk) (p "serverr" "spk" z1 spk)
          (p "serverr" "s" z0 s) (p "serverr" "s" z1 s)
          (p "serverr" "ca" z0 ca) (p "serverr" "ca" z1 ca))
        (= z0 z1))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "u" z u)
          (p "servera" "s" z s)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "u" z u)
          (p "serverr" "s" z s)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (u s name) (cookie mesg))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (s u name) (cookie data))
      (implies
        (and (p "serverr" z (idx 4)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (c u s ca name) (cr sr random32) (x rndx)
        (y expt) (spk cpk akey) (ppk skey))
      (implies
        (and (p "clientr" z 6)
          (p "clientr" "cookie" z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) "derived"))))
          (p "clientr" "c" z c) (p "clientr" "u" z u)
          (p "clientr" "s" z s) (p "clientr" "spk" z spk)
          (p "clientr" "cpk" z cpk) (p "clientr" "ca" z ca)
          (p "clientr" "cr" z cr) (p "clientr" "sr" z sr)
          (p "clientr" "x" z x) (p "clientr" "y" z y) (non (privk ca))
          (non (invk cpk)) (non (invk spk)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p "servera" z0 7) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 176)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (ugens (x (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (rule gen-st-clientr-0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 177)
  (parent 176)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (ugens (x (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey) (c u s ca name)
    (pt pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (strand-map 0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 178)
  (parent 177)
  (seen 179)
  (seen-ops
    (179
      (operation encryption-test (added-strand serverr 2)
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
      (strand-map 0 1)))
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x y rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 179)
  (parent 178)
  (unrealized (0 3) (0 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y x-0 rndx) (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 4)) ((2 6) (0 3)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor
      (cat pt "client store" u s
        (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
    (0 3))
  (strand-map 0 1)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))))
  (label 180)
  (parent 179)
  (unrealized (0 5) (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y x-0 rndx) (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener (hash ppk (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 6) (0 3))
    ((3 1) (2 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x y)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
    (2 4))
  (strand-map 0 1 2)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash "finished"
                  (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash "finished"
                    (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived"))))))
    ((recv (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (label 181)
  (parent 180)
  (unrealized (0 5) (3 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")
